fp
gsub("/","_",fp)
gsub(".qmd",".r",fp)
fp = gsub("C:/Documents and Settings/jking34/Desktop/uoepsy_courses/","",f)
fp = gsub("/","_",fp)
fp = gsub(".qmd",".r",fp)
paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/d1/",fp)
fp = paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/d1/",fp)
for(f in d1){
fp = gsub("C:/Documents and Settings/jking34/Desktop/uoepsy_courses/","",f)
fp = gsub("/","_",fp)
fp = gsub(".qmd",".r",fp)
fp = paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/d1/",fp)
knitr::purl(f,output=fp)
}
for(f in d2){
fp = gsub("C:/Documents and Settings/jking34/Desktop/uoepsy_courses/","",f)
fp = gsub("/","_",fp)
fp = gsub(".qmd",".r",fp)
fp = paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/d2/",fp)
knitr::purl(f,output=fp)
}
for(f in d3){
fp = gsub("C:/Documents and Settings/jking34/Desktop/uoepsy_courses/","",f)
fp = gsub("/","_",fp)
fp = gsub(".qmd",".r",fp)
fp = paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/d3/",fp)
knitr::purl(f,output=fp)
}
for(f in u){
fp = gsub("C:/Documents and Settings/jking34/Desktop/uoepsy_courses/","",f)
fp = gsub("/","_",fp)
fp = gsub(".qmd",".r",fp)
fp = paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/us/",fp)
knitr::purl(f,output=fp)
}
for(f in m){
fp = gsub("C:/Documents and Settings/jking34/Desktop/uoepsy_courses/","",f)
fp = gsub("/","_",fp)
fp = gsub(".qmd",".r",fp)
fp = paste0("C:/Documents and Settings/jking34/Desktop/serverchecks/ms/",fp)
knitr::purl(f,output=fp)
}
#| eval: false
ranef(smod3)
dotplot.ranef.mer(ranef(smod3))
#| eval: false
coef(smod3)
head(ranef(smod3))
fixef(smod3)
head(ranef(smod3))
40.31+9.38
smod4
smod3
schoolmot |> count(schoolid,funding)
#| eval: false
coef(smod3)
49.7-17.35
2.02+2.85
40.31 + 9.38 - 17.25
fixef(smod3)
40.31 + 9.38
49.7-17.25
40.31 + 9.38 - 17.25
ranef(smod4)
ranef(smod3)
40.31 + 9.39 - 17.25
coef(smod3)
#| echo: false
#| label: fig-crosslev1
#| fig-cap: "visual explanation of a model with a cross-level interaction"
pschools = c("Kilsyth Academy","St Andrew's Academy","Calderglen High School","St Ambrose High School", "Beeslack Community High School","The Mary Erskine School","Tarbert Academy","Stewarton Academy","St Columba's High School","Castlebrae Community High School","Penicuik High School")
plotlabs = schoolmot |> count(schoolid,funding) |> select(-n) |>
mutate(motiv=10,x=10)
plotlabs$y = predict(smod3, newdata=plotlabs)
plotlines = as.data.frame(coef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(g = 1:n(),
funding = ifelse(rowname%in%pschools,"private","state"),
fundingstate = ifelse(funding=="state",fundingstate,0),
`motiv:fundingstate` = ifelse(funding=="state",`motiv:fundingstate`,0),
data = pmap(list(`(Intercept)`,motiv,fundingstate,`motiv:fundingstate`),
~tibble(x = 0:10, .fitted = ..1 + ..2*(0:10)+..3+(..4)*(0:10)))
) |> unnest(data) |>
select(rowname,g,funding,x,.fitted)
pf <-
ggplot(schoolmot, aes(x=motiv,y=grade))+
geom_point(alpha=.1,aes(col=schoolid)) +
guides(col="none")+
geom_vline(xintercept=0,lty="dashed")+
scale_x_continuous(limits=c(-1,12),breaks=0:10) +
with_blur(geom_line(data = plotlines, aes(x=x,y=.fitted,group=g,col=funding),alpha=.4),sigma=2) +
geom_text(data=plotlabs,
aes(x=x,y=y,label=schoolid,col=funding),
hjust=0,alpha=.3)+
geom_abline(intercept=fixef(smod3)[1],slope=fixef(smod3)[2], lwd=1,col="#00a8cc") +
geom_abline(intercept=sum(fixef(smod3)[c(1,3)]),slope=sum(fixef(smod3)[c(2,4)]),
lwd=1,col="#a41ae4")+
geom_point(x=0,y=fixef(smod3)[1],size=3,col="#00a8cc")+
annotate("text",x=-.1,y=fixef(smod3)[1],
label=expression(gamma["00"]),size=5,
hjust=-.25,vjust=-.5,col="#00a8cc") +
geom_segment(x=1,xend=2,
y=(fixef(smod3)[1:2]%*%c(1,1))[[1]],
yend=(fixef(smod3)[1:2]%*%c(1,1))[[1]])+
geom_segment(x=2,xend=2,
y=(fixef(smod3)[1:2]%*%c(1,1))[[1]],
yend=(fixef(smod3)[1:2]%*%c(1,2))[[1]],
col="#00a8cc",lwd=1)+
geom_segment(x=1,xend=2,
y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
yend=(fixef(smod3)%*%c(1,1,1,1))[[1]])+
geom_segment(x=2,xend=2,
y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
yend=(fixef(smod3)%*%c(1,2,1,2))[[1]],
col="#a41ae4",lwd=1)+
geom_segment(x=2,xend=2,
y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
yend=(fixef(smod3)%*%c(1,2,1,1))[[1]],
col="#00a8cc",lwd=1)+
geom_segment(x=1,xend=2,
y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
yend=(fixef(smod3)%*%c(1,2,1,1))[[1]],
col="#00a8cc") +
geom_segment(x=0.1,xend=0.1,
y=(fixef(smod3)%*%c(1,0,0,0))[[1]],
yend=(fixef(smod3)%*%c(1,0,1,0))[[1]],
col="green4",lwd=1) +
annotate("text",x=0.1,y=33,
label=expression(gamma["01"]),size=5,
hjust=-.3,col="green4") +
annotate("text",x=2,y=(fixef(smod3)%*%c(1,1,0,0))[[1]],
label=expression(gamma["10"]),size=5,
hjust=-.2,col="#00a8cc") +
annotate("text",x=2,y=(fixef(smod3)%*%c(1.1,1,1,1))[[1]],
label=expression(gamma["11"]),size=5,
hjust=-.2,col="#a41ae4") +
#
# geom_segment(x=-.2,xend=-.2,y=fixef(smod3)[1],
#                yend=fixef(smod3)[1]+sqrt(VarCorr(smod3)[[1]][1]),
#                col="darkorange3",lwd=1) +
# annotate("text",x=-.2,y=45,
#            label=expression(sigma["0"]),size=5,
#            hjust=1.2,col="darkorange3") +
# geom_segment(x=-.2,xend=-.2,y=sum(fixef(smod3)[c(1,3)]),
#               yend=sum(fixef(smod3)[c(1,3)])+sqrt(VarCorr(smod3)[[1]][1]),
#               col="darkorange3",lwd=1) +
# annotate("text",x=-.2,y=27,
#           label=expression(sigma["0"]),size=5,
#           hjust=1.2,col="darkorange3")+
NULL
pi <- as.data.frame(ranef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(funding = ifelse(rowname%in%pschools,"private","state")) |>
ggplot(aes(x=`(Intercept)`))+
geom_area(stat = "function", fun = dnorm,args=list(mean=0,sd=sqrt(VarCorr(smod3)[[1]][1,1])),fill="#a41ae4",xlim=c(-30,30),alpha=.3)+
geom_rug(alpha=.7,aes(col=funding),lwd=1,
length = unit(0.05, "npc")) +
scale_color_manual(values=c("#00a8cc","#a41ae4"))+
geom_segment(x=0,xend=sqrt(VarCorr(smod3)[[1]][1,1]),
y=0.005, yend=0.005,
col="darkorange3",lwd=1)+
annotate("text",
y=0.01,x=sqrt(VarCorr(smod3)[[1]][1,1])/2,
label=expression(sigma["0"]),
col="darkorange3",size=5)+
guides(col="none")+
scale_y_continuous(NULL,breaks=NULL)+
labs(title="intercept deviations",x=expression(zeta["0i"]))
ps <- as.data.frame(ranef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(funding = ifelse(rowname%in%pschools,"private","state")) |>
ggplot(aes(x=motiv))+
geom_area(stat = "function", fun = dnorm,args=list(mean=0,sd=sqrt(VarCorr(smod3)[[1]][2,2])),fill="#a41ae4",xlim=c(-6,6),alpha=.3)+
geom_rug(alpha=.7,aes(col=funding),lwd=1,
length = unit(0.05, "npc")) +
geom_segment(x=0,xend=sqrt(VarCorr(smod3)[[1]][2,2]),
y=0.03, yend=0.03,
col="darkorange3",lwd=1)+
annotate("text",
y=0.06,x=sqrt(VarCorr(smod3)[[1]][2,2])/2,
label=expression(sigma["1"]),
col="darkorange3",size=5)+
guides(col="none")+
scale_color_manual(values=c("#00a8cc","#a41ae4"))+
scale_y_continuous(NULL,breaks=NULL)+
labs(title="slope deviations",x=expression(zeta["1i"]))
(pf + (pi / ps)) + plot_layout(widths=c(2,1))
#| echo: false
#| label: fig-crosslev1
#| fig-cap: "visual explanation of a model with a cross-level interaction"
pschools = c("Kilsyth Academy","St Andrew's Academy","Calderglen High School","St Ambrose High School", "Beeslack Community High School","The Mary Erskine School","Tarbert Academy","Stewarton Academy","St Columba's High School","Castlebrae Community High School","Penicuik High School")
plotlabs = schoolmot |> count(schoolid,funding) |> select(-n) |>
mutate(motiv=10,x=10)
plotlabs$y = predict(smod3, newdata=plotlabs)
plotlines = as.data.frame(coef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(g = 1:n(),
funding = ifelse(rowname%in%pschools,"private","state"),
fundingstate = ifelse(funding=="state",fundingstate,0),
`motiv:fundingstate` = ifelse(funding=="state",`motiv:fundingstate`,0),
data = pmap(list(`(Intercept)`,motiv,fundingstate,`motiv:fundingstate`),
~tibble(x = 0:10, .fitted = ..1 + ..2*(0:10)+..3+(..4)*(0:10)))
) |> unnest(data) |>
select(rowname,g,funding,x,.fitted)
pf <-
ggplot(schoolmot, aes(x=motiv,y=grade))+
geom_point(alpha=.1,aes(col=schoolid)) +
guides(col="none")+
geom_vline(xintercept=0,lty="dashed")+
scale_x_continuous(limits=c(-1,12),breaks=0:10) +
with_blur(geom_line(data = plotlines, aes(x=x,y=.fitted,group=g,col=funding),alpha=.4),sigma=2) +
geom_text(data=plotlabs,
aes(x=x,y=y,label=schoolid,col=funding),
hjust=0,alpha=.3)+
geom_abline(intercept=fixef(smod3)[1],slope=fixef(smod3)[2], lwd=1,col="#00a8cc") +
geom_abline(intercept=sum(fixef(smod3)[c(1,3)]),slope=sum(fixef(smod3)[c(2,4)]),
lwd=1,col="#a41ae4")+
geom_point(x=0,y=fixef(smod3)[1],size=3,col="#00a8cc")+
annotate("text",x=-.1,y=fixef(smod3)[1],
label=expression(gamma["00"]),size=5,
hjust=-.25,vjust=-.5,col="#00a8cc") +
# geom_segment(x=1,xend=2,
#              y=(fixef(smod3)[1:2]%*%c(1,1))[[1]],
#              yend=(fixef(smod3)[1:2]%*%c(1,1))[[1]])+
#  geom_segment(x=2,xend=2,
#              y=(fixef(smod3)[1:2]%*%c(1,1))[[1]],
#              yend=(fixef(smod3)[1:2]%*%c(1,2))[[1]],
#              col="#00a8cc",lwd=1)+
#  geom_segment(x=1,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,1,1,1))[[1]])+
#  geom_segment(x=2,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,2,1,2))[[1]],
#              col="#a41ae4",lwd=1)+
#  geom_segment(x=2,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,2,1,1))[[1]],
#              col="#00a8cc",lwd=1)+
#  geom_segment(x=1,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,2,1,1))[[1]],
#              col="#00a8cc") +
#  geom_segment(x=0.1,xend=0.1,
#              y=(fixef(smod3)%*%c(1,0,0,0))[[1]],
#              yend=(fixef(smod3)%*%c(1,0,1,0))[[1]],
#              col="green4",lwd=1) +
#  annotate("text",x=0.1,y=33,
#            label=expression(gamma["01"]),size=5,
#            hjust=-.3,col="green4") +
#
#  annotate("text",x=2,y=(fixef(smod3)%*%c(1,1,0,0))[[1]],
#            label=expression(gamma["10"]),size=5,
#            hjust=-.2,col="#00a8cc") +
#  annotate("text",x=2,y=(fixef(smod3)%*%c(1.1,1,1,1))[[1]],
#            label=expression(gamma["11"]),size=5,
#            hjust=-.2,col="#a41ae4") +
#
# geom_segment(x=-.2,xend=-.2,y=fixef(smod3)[1],
#                yend=fixef(smod3)[1]+sqrt(VarCorr(smod3)[[1]][1]),
#                col="darkorange3",lwd=1) +
# annotate("text",x=-.2,y=45,
#            label=expression(sigma["0"]),size=5,
#            hjust=1.2,col="darkorange3") +
# geom_segment(x=-.2,xend=-.2,y=sum(fixef(smod3)[c(1,3)]),
#               yend=sum(fixef(smod3)[c(1,3)])+sqrt(VarCorr(smod3)[[1]][1]),
#               col="darkorange3",lwd=1) +
# annotate("text",x=-.2,y=27,
#           label=expression(sigma["0"]),size=5,
#           hjust=1.2,col="darkorange3")+
NULL
pi <- as.data.frame(ranef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(funding = ifelse(rowname%in%pschools,"private","state")) |>
ggplot(aes(x=`(Intercept)`))+
geom_area(stat = "function", fun = dnorm,args=list(mean=0,sd=sqrt(VarCorr(smod3)[[1]][1,1])),fill="#a41ae4",xlim=c(-30,30),alpha=.3)+
geom_rug(alpha=.7,aes(col=funding),lwd=1,
length = unit(0.05, "npc")) +
scale_color_manual(values=c("#00a8cc","#a41ae4"))+
geom_segment(x=0,xend=sqrt(VarCorr(smod3)[[1]][1,1]),
y=0.005, yend=0.005,
col="darkorange3",lwd=1)+
annotate("text",
y=0.01,x=sqrt(VarCorr(smod3)[[1]][1,1])/2,
label=expression(sigma["0"]),
col="darkorange3",size=5)+
guides(col="none")+
scale_y_continuous(NULL,breaks=NULL)+
labs(title="intercept deviations",x=expression(zeta["0i"]))
ps <- as.data.frame(ranef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(funding = ifelse(rowname%in%pschools,"private","state")) |>
ggplot(aes(x=motiv))+
geom_area(stat = "function", fun = dnorm,args=list(mean=0,sd=sqrt(VarCorr(smod3)[[1]][2,2])),fill="#a41ae4",xlim=c(-6,6),alpha=.3)+
geom_rug(alpha=.7,aes(col=funding),lwd=1,
length = unit(0.05, "npc")) +
geom_segment(x=0,xend=sqrt(VarCorr(smod3)[[1]][2,2]),
y=0.03, yend=0.03,
col="darkorange3",lwd=1)+
annotate("text",
y=0.06,x=sqrt(VarCorr(smod3)[[1]][2,2])/2,
label=expression(sigma["1"]),
col="darkorange3",size=5)+
guides(col="none")+
scale_color_manual(values=c("#00a8cc","#a41ae4"))+
scale_y_continuous(NULL,breaks=NULL)+
labs(title="slope deviations",x=expression(zeta["1i"]))
(pf + (pi / ps)) + plot_layout(widths=c(2,1))
#| echo: false
#| label: fig-crosslev1
#| fig-cap: "visual explanation of a model with a cross-level interaction"
pschools = c("Kilsyth Academy","St Andrew's Academy","Calderglen High School","St Ambrose High School", "Beeslack Community High School","The Mary Erskine School","Tarbert Academy","Stewarton Academy","St Columba's High School","Castlebrae Community High School","Penicuik High School")
plotlabs = schoolmot |> count(schoolid,funding) |> select(-n) |>
mutate(motiv=10,x=10)
plotlabs$y = predict(smod3, newdata=plotlabs)
plotlines = as.data.frame(coef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(g = 1:n(),
funding = ifelse(rowname%in%pschools,"private","state"),
fundingstate = ifelse(funding=="state",fundingstate,0),
`motiv:fundingstate` = ifelse(funding=="state",`motiv:fundingstate`,0),
data = pmap(list(`(Intercept)`,motiv,fundingstate,`motiv:fundingstate`),
~tibble(x = 0:10, .fitted = ..1 + ..2*(0:10)+..3+(..4)*(0:10)))
) |> unnest(data) |>
select(rowname,g,funding,x,.fitted)
pf <-
ggplot(schoolmot, aes(x=motiv,y=grade))+
geom_point(alpha=.1,aes(col=schoolid)) +
guides(col="none")+
geom_vline(xintercept=0,lty="dashed")+
scale_x_continuous(limits=c(-1,12),breaks=0:10) +
with_blur(geom_line(data = plotlines, aes(x=x,y=.fitted,group=g,col=funding),alpha=.4),sigma=2) +
geom_text(data=plotlabs,
aes(x=x,y=y,label=schoolid,col=funding),
hjust=0,alpha=.3)+
geom_abline(intercept=fixef(smod3)[1],slope=fixef(smod3)[2], lwd=1,col="#00a8cc") +
geom_abline(intercept=sum(fixef(smod3)[c(1,3)]),slope=sum(fixef(smod3)[c(2,4)]),
lwd=1,col="#a41ae4")+
geom_point(x=0,y=fixef(smod3)[1],size=3,col="#00a8cc")+
# annotate("text",x=-.1,y=fixef(smod3)[1],
#         label=expression(gamma["00"]),size=5,
#         hjust=-.25,vjust=-.5,col="#00a8cc") +
# geom_segment(x=1,xend=2,
#              y=(fixef(smod3)[1:2]%*%c(1,1))[[1]],
#              yend=(fixef(smod3)[1:2]%*%c(1,1))[[1]])+
#  geom_segment(x=2,xend=2,
#              y=(fixef(smod3)[1:2]%*%c(1,1))[[1]],
#              yend=(fixef(smod3)[1:2]%*%c(1,2))[[1]],
#              col="#00a8cc",lwd=1)+
#  geom_segment(x=1,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,1,1,1))[[1]])+
#  geom_segment(x=2,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,2,1,2))[[1]],
#              col="#a41ae4",lwd=1)+
#  geom_segment(x=2,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,2,1,1))[[1]],
#              col="#00a8cc",lwd=1)+
#  geom_segment(x=1,xend=2,
#              y=(fixef(smod3)%*%c(1,1,1,1))[[1]],
#              yend=(fixef(smod3)%*%c(1,2,1,1))[[1]],
#              col="#00a8cc") +
#  geom_segment(x=0.1,xend=0.1,
#              y=(fixef(smod3)%*%c(1,0,0,0))[[1]],
#              yend=(fixef(smod3)%*%c(1,0,1,0))[[1]],
#              col="green4",lwd=1) +
#  annotate("text",x=0.1,y=33,
#            label=expression(gamma["01"]),size=5,
#            hjust=-.3,col="green4") +
#
#  annotate("text",x=2,y=(fixef(smod3)%*%c(1,1,0,0))[[1]],
#            label=expression(gamma["10"]),size=5,
#            hjust=-.2,col="#00a8cc") +
#  annotate("text",x=2,y=(fixef(smod3)%*%c(1.1,1,1,1))[[1]],
#            label=expression(gamma["11"]),size=5,
#            hjust=-.2,col="#a41ae4") +
#
# geom_segment(x=-.2,xend=-.2,y=fixef(smod3)[1],
#                yend=fixef(smod3)[1]+sqrt(VarCorr(smod3)[[1]][1]),
#                col="darkorange3",lwd=1) +
# annotate("text",x=-.2,y=45,
#            label=expression(sigma["0"]),size=5,
#            hjust=1.2,col="darkorange3") +
# geom_segment(x=-.2,xend=-.2,y=sum(fixef(smod3)[c(1,3)]),
#               yend=sum(fixef(smod3)[c(1,3)])+sqrt(VarCorr(smod3)[[1]][1]),
#               col="darkorange3",lwd=1) +
# annotate("text",x=-.2,y=27,
#           label=expression(sigma["0"]),size=5,
#           hjust=1.2,col="darkorange3")+
NULL
pi <- as.data.frame(ranef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(funding = ifelse(rowname%in%pschools,"private","state")) |>
ggplot(aes(x=`(Intercept)`))+
geom_area(stat = "function", fun = dnorm,args=list(mean=0,sd=sqrt(VarCorr(smod3)[[1]][1,1])),fill="#a41ae4",xlim=c(-30,30),alpha=.3)+
geom_rug(alpha=.7,aes(col=funding),lwd=1,
length = unit(0.05, "npc")) +
scale_color_manual(values=c("#00a8cc","#a41ae4"))+
geom_segment(x=0,xend=sqrt(VarCorr(smod3)[[1]][1,1]),
y=0.005, yend=0.005,
col="darkorange3",lwd=1)+
annotate("text",
y=0.01,x=sqrt(VarCorr(smod3)[[1]][1,1])/2,
label=expression(sigma["0"]),
col="darkorange3",size=5)+
guides(col="none")+
scale_y_continuous(NULL,breaks=NULL)+
labs(title="intercept deviations",x=expression(zeta["0i"]))
ps <- as.data.frame(ranef(smod3)$schoolid) |>
rownames_to_column() |>
mutate(funding = ifelse(rowname%in%pschools,"private","state")) |>
ggplot(aes(x=motiv))+
geom_area(stat = "function", fun = dnorm,args=list(mean=0,sd=sqrt(VarCorr(smod3)[[1]][2,2])),fill="#a41ae4",xlim=c(-6,6),alpha=.3)+
geom_rug(alpha=.7,aes(col=funding),lwd=1,
length = unit(0.05, "npc")) +
geom_segment(x=0,xend=sqrt(VarCorr(smod3)[[1]][2,2]),
y=0.03, yend=0.03,
col="darkorange3",lwd=1)+
annotate("text",
y=0.06,x=sqrt(VarCorr(smod3)[[1]][2,2])/2,
label=expression(sigma["1"]),
col="darkorange3",size=5)+
guides(col="none")+
scale_color_manual(values=c("#00a8cc","#a41ae4"))+
scale_y_continuous(NULL,breaks=NULL)+
labs(title="slope deviations",x=expression(zeta["1i"]))
(pf + (pi / ps)) + plot_layout(widths=c(2,1))
66/101
1/3.5
101-66
35/101
101-72
101-72-6
23/101
1/3.5
1/(4.5)
23/101
35/100
35/100
35/(100-35)
50/(100-50)
45/55
40/60
0/100
1/4.5
23/101
20/100
1/4
1/5
1/3.5
1/4.5
23/101
20/100
23+6
29/100
29/101
1/3.5
(101-72)/101
23/101
101/23
1/4.4
101/29
((101-6)-72)/101
((101-6)-72)/(101-6)
23 / (101-6)
(101-6)/23
library(broom.mixed)
augment(smod3)
augment(smod3) |>
ggplot(aes(x = motiv, y = .fitted, col = funding)) +
stat_summary(geom = "pointrange")
effect(term = "motiv*funding", mod = smod3)
effect(term = "motiv*funding", mod = smod3) |>
as.data.frame()
effect(term = "motiv*funding", mod = smod3) |>
as.data.frame() |>
ggplot(aes(x = motiv, col = funding, y = fit)) +
geom_ribbon(aes(ymin = lower, ymax = upper))
effect(term = "motiv*funding", mod = smod3) |>
as.data.frame() |>
ggplot(aes(x = motiv, col = funding, y = fit)) +
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .3)
effect(term = "motiv*funding", mod = smod3) |>
as.data.frame() |>
ggplot(aes(x = motiv, col = funding, fill = funding)) +
geom_ribbon(aes(y = fit, ymin = lower, ymax = upper), alpha = .3)
effect(term = "motiv*funding", mod = smod3) |>
as.data.frame() |>
ggplot(aes(x = motiv, col = funding, fill = funding)) +
geom_line(aes(y = fit)) +
geom_ribbon(aes(y = fit, ymin = lower, ymax = upper), alpha = .3)
ggplot(data = schoolmot, aes(x = motiv, col = funding, fill = funding)) +
geom_line(aes(y = grade)) +
geom_line(data = efplot, aes(y = fit)) +
geom_ribbon(data = efplot, aes(y = fit, ymin = lower, ymax = upper), alpha = .3)
efplot <- effect(term = "motiv*funding", mod = smod3) |>
as.data.frame()
ggplot(data = schoolmot, aes(x = motiv, col = funding, fill = funding)) +
geom_line(aes(y = grade)) +
geom_line(data = efplot, aes(y = fit)) +
geom_ribbon(data = efplot, aes(y = fit, ymin = lower, ymax = upper), alpha = .3)
ggplot(data = schoolmot, aes(x = motiv, col = funding, fill = funding)) +
geom_point(aes(y = grade)) +
geom_line(data = efplot, aes(y = fit)) +
geom_ribbon(data = efplot, aes(y = fit, ymin = lower, ymax = upper), alpha = .3)
ggplot(data = schoolmot, aes(x = motiv, col = funding, fill = funding)) +
geom_point(aes(y = grade), alpha = .3) +
geom_line(data = efplot, aes(y = fit)) +
geom_ribbon(data = efplot, aes(y = fit, ymin = lower, ymax = upper), alpha = .3)
