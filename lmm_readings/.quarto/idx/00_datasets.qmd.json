{"title":"Practice Datasets","markdown":{"yaml":{"title":"Practice Datasets","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"schoolmot.csv - motivation and grades in school children <br><span class=\"tag\">\\#cross-sectional</span>","containsRefs":false,"markdown":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(xaringanExtra)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggdist)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\nlibrary(lme4)\n```\n\n:::lo\n\nBelow are various datasets from these readings and from lectures and exercises across our courses. For each one, there is a quick explanation of the study design which also details the research aims of the project.  \n  \nPick one of the datasets to test yourself with fitting, checking, interpreting, and reporting on multilevel models. \n\n:::\n\n::: {.callout-note collapse=\"true\"}\n\nThis dataset contains information on 900 children from 30 different schools across Scotland. The data was collected as part of a study looking at **whether education-related motivation is associated with school grades. This is expected to be different for state vs privately funded schools.**   \nAll children completed an 'education motivation' questionnaire, and their end-of-year grade average has been recorded.    \n\nData are available at [https://uoepsy.github.io/data/schoolmot.csv](https://uoepsy.github.io/data/schoolmot.csv).  \n\n```{r}\n#| echo: false\ntibble(variable=names(read_csv(\"https://uoepsy.github.io/data/schoolmot.csv\")),\n       description = c(\n         \"Child's Education Motivation Score (range 0 - 10)\",\n         \"Funding ('state' or 'private')\",\n         \"Name of School that the child attends\",\n         \"Child's end-of-year grade average (0-100)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/schoolmot.csv\")\n\nmod1 <- lmer(grade ~ motiv * funding + \n               (1 + motiv | schoolid), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_lifesatscot.csv - <br><span class=\"tag\">\\#cross-sectional</span>\n\nThese data come from 112 people across 12 different Scottish dwellings (cities and towns). Information is captured on their ages and a measure of life satisfaction. The researchers are interested in if there is an association between age and life-satisfaction. \n\nData are available at [https://uoepsy.github.io/data/lmm_lifesatscot.csv](https://uoepsy.github.io/data/lmm_lifesatscot.csv){target=\"_blank\"}.\n\n```{r}\n#| echo: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_lifesatscot.csv\")\ntibble(\n  variable = names(df),\n  description = c(\"Age (years)\",\"Life Satisfaction score\",\"Dwelling (town/city in Scotland)\",\"Size of Dwelling (> or <100k people)\")\n) |> gt::gt()\n```\n\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_lifesatscot.csv\")\n\nmod <- lmer(lifesat ~ 1 + age + (1 + age | dwelling), df)\n\n# if you want to see a cross-level interaction (not relevant for RQ):\ndf$age <- df$age/10 # makes fitting easier\nmod2 <- lmer(lifesat ~ 1 + age * size + (1 + age | dwelling), df)\n```\n\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_jsup.csv - Workplace pride<br><span class=\"tag\">\\#cross-sectional</span>\n\nA questionnaire was sent to all UK civil service departments, and the lmm_jsup.csv dataset contains all responses that were received. Some of these departments work as hybrid or 'virtual' departments, with a mix of remote and office-based employees. Others are fully office-based. \n\nThe questionnaire included items asking about how much the respondent believe in the department and how it engages with the community, what it produces, how it operates and how treats its people. A composite measure of 'workplace-pride' was constructed for each employee. Employees in the civil service are categorised into 3 different roles: A, B and C. The roles tend to increase in responsibility, with role C being more managerial, and role A having less responsibility. We also have data on the length of time each employee has been in the department (sometimes new employees come straight in at role C, but many of them start in role A and work up over time). \n\nWe're interested in whether the different roles are associated with differences in workplace-pride.  \n\nData are available at [https://uoepsy.github.io/data/lmm_jsup.csv](https://uoepsy.github.io/data/lmm_jsup.csv){target=\"_blank\"}.\n\n\n```{r}\n#| echo: false\njsup <- read_csv(\"https://uoepsy.github.io/data/lmm_jsup.csv\")\ntibble(\n  variable = names(jsup),\n  description = c(\n    \"Name of government department\",\n    \"Department Acronym\",\n    \"Whether the department functions as hybrid department with various employees working remotely (1), or as a fully in-person office (0)\",\n    \"Employee role (A, B or C)\",\n    \"Employees seniority point. These map to roles, such that role A is 0-4, role B is 5-9, role C is 10-14. Higher numbers indicate more seniority\",\n    \"Length of employment in the department (years)\",\n    \"Composite Measure of 'Workplace Pride'\")\n) |> gt::gt()\n```\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_jsup.csv\")\n\n# either Roles or Seniority would work here:\nmod <- lmer(wp ~ employment_length + seniority + (1 + seniority | dept), df)\n\n# doesn't converge:\nmod <- lmer(wp ~ employment_length + role + (1 + role | dept), df)\nmod <- lmer(wp ~ employment_length + role + (1 | dept), df)\n```\n`r solend()`\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### wellbeingwork3.rda - work patterns and mental wellbeing <br><span class=\"tag\">\\#longitudinal</span>\n\nThe \"Wellbeing in Work\" dataset contains information on employee wellbeing, assessed at baseline (start of study), 12 months post, 24 months post, and 36 months post.  over the course of 36 months. \nParticipants were randomly assigned to one of three employment conditions:\n\n- control: No change to employment. Employees continue at 5 days a week, with standard allocated annual leave quota.    \n- unlimited_leave : Employees were given no limit to their annual leave, but were still expected to meet required targets as specified in their job description. \n- fourday_week: Employees worked a 4 day week for no decrease in pay, and were still expected to meet required targets as specified in their job description.\n\nThe researchers have two main questions: **Overall, did the participants' wellbeing stay the same or did it change? Did the employment condition groups differ in the how wellbeing changed over the assessment period?**     \n\nData are available (in **.rda** format) at [https://uoepsy.github.io/data/wellbeingwork3.rda](https://uoepsy.github.io/data/wellbeingwork3.rda)\n\n```{r}\n#| echo: false\nload(url(\"https://uoepsy.github.io/data/wellbeingwork3.rda\"))\nd3 <- wellbeingwork3\ntibble(variable=names(d3),\n       description = c(\n         \"Participant ID\",\n         \"Timepoint (0 = baseline, 1 = 12 months, 2 = 24 months, 3 = 36 months)\",\n         \"Employment Condition ('control' = 5 day week, 28 days of leave. 'unlimited_leave' = 5 days a week, unlimited leave. 'fourday_week' = 4 day week, 28 days of leave)\",\n         \"Wellbeing score (Warwick Edinburgh Mental Wellbeing Scale). Range 15 - 75, with higher scores indicating better mental wellbeing\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\nload(url(\"https://uoepsy.github.io/data/wellbeingwork3.rda\"))\n\nmod1 <- lmer(Wellbeing~TimePoint+(1+TimePoint|ID), \n             data = wellbeingwork3)\nmod2 <- lmer(Wellbeing~TimePoint+Condition+(1+TimePoint|ID), \n             data = wellbeingwork3)\nmod3 <- lmer(Wellbeing~TimePoint*Condition+(1+TimePoint|ID), \n             data = wellbeingwork3)\nanova(mod1,mod2,mod3)\n\nsummary(mod3)\n```\n`r solend()`\n\n\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### toy2.csv - Toys!<br><span class=\"tag\">\\#cross-sectional</span>\n\nThis example builds on one from the USMR course, where the lectures explored linear regression with a \"toy dataset\" looking at how **hours of practice influences the reading age** of different toy characters (see [USMR Week 7 Lecture](https://uoepsy.github.io/usmr/2324/lectures/lecture06.html#/learning-to-read-1){target=\"_blank\"}). Here, we broaden our scope to the investigation of how practice affects reading age for **all** toys (not just Martin's Playmobil characters).  \n\nData are available at [https://uoepsy.github.io/data/toy2.csv](https://uoepsy.github.io/data/toy2.csv){target=\"_blank\"} containing information on 129 different toy characters that come from a selection of different families/types of toy.   \n\n```{r echo=FALSE, message=FALSE,warning=FALSE}\nlibrary(gt)\ntibble(variable=names(read_csv(\"https://uoepsy.github.io/data/toy2.csv\")),\n       description=c(\"Type of Toy\",\"Year Released\",\"Character\",\"Hours of practice per week\",\"Reading Age\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/toy2.csv\")\n\nmod <- lmer(R_AGE ~ 1 + hrs_week + (1 + hrs_week | toy_type), df)\n```\n`r solend()`\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### LAAwellbeing.csv - mental wellbeing across Scotland<br><span class=\"tag\">\\#cross-sectional</span>\n\nResearchers want to study the **relationship between time spent outdoors and mental wellbeing**, across all of Scotland. They contact all the Local Authority Areas (LAAs) and ask them to collect data for them, with participants completing the Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), a self-report measure of mental health and well-being, and being asked to estimate the average number of hours they spend outdoors each week. Twenty of the Local Authority Areas provided data. \n\nData are available at [https://uoepsy.github.io/data/LAAwellbeing.csv](https://uoepsy.github.io/data/LAAwellbeing.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/LAAwellbeing.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"Participant Identifier\",\n                \"Participant Name\",\n                \"Local Authority Area\",\n                \"Number of hours spent outdoors per week\",\n                \"Wellbeing score (Warwick Edinburgh Mental Wellbeing Scale). Range 15 - 75, with higher scores indicating better mental wellbeing\",\n                \"Population density of local authority area (number of people per square km)\")\n) |> gt::gt()\n\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/LAAwellbeing.csv\")\n\nmod1 <- lmer(wellbeing ~ density + outdoor_time + \n       (1 + outdoor_time | laa), \n       data = df) \n\nsummary(mod1)\n```\n\neaster egg: check for influential people! \n\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### stressint.csv - CBT and stress levels<br><span class=\"tag\">\\#longitudinal</span>\n\nThese data are simulated to represent data from 50 participants, each measured at 3 different time-points (pre, during, and post) on a measure of stress. Participants were randomly allocated such that half received some cognitive behavioural therapy (CBT) treatment, and half did not. This study is interested in assessing **whether the two groups (control vs treatment) differ in changes in stress across the 3 time points**. \n\nThe data are available at [https://uoepsy.github.io/data/stressint.csv](https://uoepsy.github.io/data/stressint.csv).  \n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/stressint.csv\")),\n  description = c(\"Participant Identifier\",\"Stress (range 0 to 100)\",\"Time (pre/post/during)\",\n                  \"Whether participant is in the CBT group or control group\")\n) |> gt::gt()\n```\n\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressint.csv\")\ndf$time <- factor(df$time, levels=c(\"Pre\",\"During\",\"Post\"))\n```\n\nTemptation is to fit the below, but it won't work, because each pid has only 1 obs for each time-point, so we're overfitting (the whole *Error: number of observations (=150) <= number of random effects (=150) for term* message).  \n```{r}\n#| eval: false\n#| error: true\n#| warning: true\n#| message: true\nmod1 <- lmer(stress ~ time*group + \n               (1 + time|ppt), \n             data = df)\n```\n\n```{r}\n#| eval: false\nmod1 <- lmer(stress ~ time*group + \n               (1 |ppt), \n             data = df)\n\nsummary(mod1)\n```\n\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### drivingmusicwithin.csv - the influence of music on driving speeds<br><span class=\"tag\">\\#repeated-measures</span>\n\nThese data are simulated to represent data from a fake experiment, in which participants were asked to drive around a route in a 30mph zone. Each participant completed the route 3 times (i.e. \"repeated measures\"), but each time they were listening to different audio (either speech, classical music or rap music). Their average speed across the route was recorded. \nThis is a fairly simple design, that we might use to ask **\"how is the type of audio being listened to associated with driving speeds?\"** \n\nThe data are available at [https://uoepsy.github.io/data/drivingmusicwithin.csv](https://uoepsy.github.io/data/drivingmusicwithin.csv).  \n\n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/drivingmusicwithin.csv\")),\n  description = c(\"Participant Identifier\",\"Avg Speed Driven on Route (mph)\",\"Music listened to while driving (classical music / rap music / spoken word)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/drivingmusicwithin.csv\")\n```\n\nTemptation is to fit the below, but it won't work, because each pid has only 1 obs for each music, so we're overfitting\n```{r}\n#| eval: false\n#| error: true\n#| warning: true\n#| message: true\nmod1 <- lmer(speed ~ music + \n               (1 + music | pid), \n             data = df)\n```\n\n```{r}\n#| eval: false\nmod1 <- lmer(speed ~ music + \n               (1 | pid), \n             data = df)\n\nsummary(mod1)\n```\n\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### dapr3_mannequin.csv - the role of mannequins in clothing purchases<br><span class=\"tag\">\\#repeated-measures</span>\n\n**Does clothing seem more attractive to shoppers when it is viewed on a model, and is this dependent on item price?** 30 participants were presented with a set of pictures of items of clothing, and rated each item how likely they were to buy it. Each participant saw 20 items, ranging in price from £5 to £100. 15 participants saw these items worn by a model, while the other 15 saw the items against a white background.  \n\nData are available at [https://uoepsy.github.io/data/dapr3_mannequin.csv](https://uoepsy.github.io/data/dapr3_mannequin.csv)\n\n```{r}\n#| eval: false\n#| echo: false\nset.seed(15)\nN = 600\nn_groups = 30\ng = rep(1:n_groups, e = N/n_groups)      # the group identifier\nx = rep(seq(5,100,len=20),n_groups)\nb = rep(0:1,e=15)[g]\nre0 = rnorm(n_groups, sd = 1)  # random intercepts\nre  = re0[g]\nrex = rnorm(n_groups, sd = .4)  # random effects\nre_x  = rex[g]\nlp = (0 + re) + (1 + re_x)*scale(x) + (.5 * b) + (.5*scale(x)*b)\ny = rnorm(N, mean = lp, sd = 2) # create a continuous target variable\ndf = data.frame(x, g=factor(g), b=b, y)\n\nclothesdf <- df |> transmute(\n  purch_rating = round(56.4+scale(y)[,1]*16.2),\n  price = round(x),\n  ppt = factor(paste0(\"ppt_\",g)),\n  condition = ifelse(b==0,\"item_only\",\"model\")\n)\n# write_csv(clothesdf, \"../../data/dapr3_mannequin.csv\")\n```\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/dapr3_mannequin.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"Purchase Rating (sliding scale 0 to 100, with higher ratings indicating greater perceived likelihood of purchase)\",\n                \"Price presented with item (range £5 to £100)\",\n                \"Participant Identifier\",\n                \"Whether items are seen on a model or on a white background\")\n) |> gt::gt()\n\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\ndf <- read_csv(\"https://uoepsy.github.io/data/dapr3_mannequin.csv\")\n\n#scale price to help convergence\n#change 1 in price is now change of £10\ndf$price <- df$price/10\n\nmod1 <- lmer(purch_rating ~ price*condition + \n       (1+price|ppt), \n       data = df)\n  \nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### crqeds.csv - routine and emotion dysregulation in children<br><span class=\"tag\">\\#cross-sectional</span>\n\n**Are children with more day-to-day routine better at regulating their emotions?** A study of 200 children from 20 schools (9 private schools and 11 state schools) completed a survey containing the Emotion Dysregulation Scale (EDS) and the Child Routines Questionnaire (CRQ). \n\nData are available at [https://uoepsy.github.io/data/crqeds.csv](https://uoepsy.github.io/data/crqeds.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/crqeds.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"School Identifier\",\n                \"Emotion Dysregulation Score (range 1-6, higher values indicate more *dys*regulation of emotions)\",\n                \"Childhood Routine Questionnaire Score (range 0-7, higher values indicate more day-to-day routine)\",\n                \"School type (private / state)\")\n) |> gt::gt()\n\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/crqeds.csv\")\n\nmod1 <- lmer(EDS ~ schooltype + CRQ + \n       (1 + CRQ | schoolid), \n       data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_ef_sdmt.csv - Audio interference in executive functioning<br><span class=\"tag\">\\#repeated-measures</span>\n\nThis data is from a simulated study that aims to investigate the following research question: \n\n**How do different types of audio interfere with executive functioning, and does this interference differ depending upon whether or not noise-cancelling headphones are used?** \n\n30 healthy volunteers each completed the Symbol Digit Modalities Test (SDMT) - a commonly used test to assess processing speed and motor speed - a total of 15 times. During the tests, participants listened to either no audio (5 tests), white noise (5 tests) or classical music (5 tests). Half the participants listened via active-noise-cancelling headphones, and the other half listened via speakers in the room. Unfortunately, lots of the tests were not administered correctly, and so not every participant has the full 15 trials worth of data.  \n\nData are available at [https://uoepsy.github.io/data/lmm_ef_sdmt.csv](https://uoepsy.github.io/data/lmm_ef_sdmt.csv).  \n\n```{r}\n#| echo: false\nefrep <- read_csv(\"https://uoepsy.github.io/data/lmm_ef_sdmt.csv\")\ntibble(variable=names(efrep),\n       description = c(\n         \"Participant ID\",\n         \"Audio heard during the test ('no_audio', 'white_noise','music')\",\n         \"Whether the participant listened via speakers (S) in the room or via noise cancelling headphones (H)\",\n         \"Symbol Digit Modalities Test (SDMT) score\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_ef_sdmt.csv\")\n\nmod1 <- lmer(SDMT ~ audio * headphones + \n               (1 + audio | PID), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_nssjobsat.csv - <br><span class=\"tag\">\\#cross-sectional</span>\n\n```{r}\n#| echo: false\ndf<-read_csv(\"https://uoepsy.github.io/data/msmr_nssjobsat.csv\")\n```\n\nLet's suppose we are studying employee job satisfaction at the university, and we want to estimate the association between pay-scale and job satisfaction, controlling for the NSS rating of departments.   \nWe have `r nrow(df)` employees from `r n_distinct(df$dept)` different departments, and we got them to fill in a job satisfaction questionnaire, and got information on what their payscale was. We have also taken information from the national student survey on the level of student satisfaction for each department.  \n\nEach datapoint here represents an individual employee, and these employees are grouped into departments.  \n\nData are available at [https://uoepsy.github.io/data/msmr_nssjobsat.csv](https://uoepsy.github.io/data/msmr_nssjobsat.csv).  \n\n```{r}\n#| echo: false\ndf<-read_csv(\"https://uoepsy.github.io/data/msmr_nssjobsat.csv\")\ntibble(variable=names(df),\n       description = c(\n         \"National Student Satisfaction Rating for the Department\",\n         \"Department name\",\n         \"Pay scale of employee\",\n         \"Job satisfaction of employee\",\n         \"Binary question of whether the employee considered themselves to be satisfied with their work (1) or not (0)\"\n       )\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf<-read_csv(\"https://uoepsy.github.io/data/msmr_nssjobsat.csv\")\n\nmod <- lmer(jobsat ~ 1 + NSSrating + payscale + (1 + payscale | dept), df)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_apespecies.csv & lmm_apeage.csv - dominance in adolescence of great apes<br><span class=\"tag\">\\#longitudinal</span>\n\nWe have data from a large sample of great apes who have been studied between the ages of 1 to 10 years old (i.e. during adolescence). Our data includes 4 species of great apes: Chimpanzees, Bonobos, Gorillas and Orangutans. Each ape has been assessed on a primate dominance scale at various ages. Data collection was not very rigorous, so apes do not have consistent assessment schedules (i.e., one may have been assessed at ages 1, 3 and 6, whereas another at ages 2 and 8).  \n\nThe researchers are interested in examining **how the adolescent development of dominance in great apes differs between species.**  \n\nData on the dominance scores of the apes are available at [https://uoepsy.github.io/data/lmm_apeage.csv](https://uoepsy.github.io/data/lmm_apeage.csv){target=\"_blank\"} and the information about which species each ape is are in [https://uoepsy.github.io/data/lmm_apespecies.csv](https://uoepsy.github.io/data/lmm_apespecies.csv){target=\"_blank\"}.  \n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n```{r}\n#| echo: false\n#| label: tbl-spec1\n#| tbl-cap: \"Data Dictionary: lmm_apespecies.csv\"  \nape_species <- read_csv(\"../../data/lmm_apespecies.csv\")\ntibble(\n  variable = names(ape_species),\n  description = c(\"Ape Name\",\"Species (Bonobo, Chimpanzee, Gorilla, Orangutan)\")\n) |> gt::gt()\n```\n:::\n::: {.column width=\"10%\"}\n\n:::\n::: {.column width=\"45%\"}\n```{r}\n#| echo: false\n#| label: tbl-spec2\n#| tbl-cap: \"Data Dictionary: lmm_apeage.csv\"  \nape_age <- read_csv(\"../../data/lmm_apeage.csv\")\ntibble(\n  variable = names(ape_age),\n  description = c(\"Ape Name\",\"Age at assessment (years)\",\"Dominance (Z-scored)\")\n) |> gt::gt()\n```\n\n:::\n::::\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndfape1 <- read_csv(\"https://uoepsy.github.io/data/lmm_apespecies.csv\")\ndfape2 <- read_csv(\"https://uoepsy.github.io/data/lmm_apeage.csv\")\n\ndf <- full_join(dfape1, dfape2)\n```\n\nsome cleaning is needed:\n```{r}\n#| eval: false\ndf <- df |> \n  mutate(\n    # fix species typos\n    species = case_when(\n      species %in% c(\"chimp\",\"chimpanzee\") ~ \"chimp\",\n      species %in% c(\"gorilla\",\"gorrila\") ~ \"gorilla\",\n      TRUE ~ species\n    )\n  ) |>\n    filter(\n      # get rid of ages -99\n      age > 0, \n      # keep when dominance is between -5 and 5 \n      # (5 here is a slightly arbitrary choice, but you can see from\n      # our checks that this will only exclude the two extreme datapoints\n      # that are 21.2 and 19.4\n      (dominance < 5 & dominance > -5) \n    )\n```\n\nmodel comparison answers \"do species differ in growth of dominance?\"  \nfor \"*how* do *specific* species differ?\" we look at fixed effects.  \n```{r}\n#| eval: false\nmod <- lmer(dominance ~ age * species + (1 + age | ape), df)\nmod.rstr <- lmer(dominance ~ age + species + (1 + age | ape), df)\n\nanova(mod.rstr, mod)\n```\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_mindfuldecline.csv - mindfulness and cognitive decline<br><span class=\"tag\">\\#longitudinal</span>\n\nA study is interested in examining **whether engaging in mindfulness can prevent cognitive decline in older adults**. They recruit a sample of 20 participants at age 60, and administer the Addenbrooke's Cognitive Examination (ACE) every 2 years (until participants were aged 78). Half of the participants complete weekly mindfulness sessions, while the remaining participants did not.   \n\n  \nData are available at [https://uoepsy.github.io/data/lmm_mindfuldecline.csv](https://uoepsy.github.io/data/lmm_mindfuldecline.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\nmmd <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldecline.csv\")\ntibble(\n  variable=names(mmd),\n  description=c(\n    \"Site Identifier\",\n    \"Participant Identifier\",\n                \"Whether the participant engages in mindfulness or not (control/mindfulness)\",\n                \"Study Visit Number (1 - 10)\",\n                \"Age (in years) at study visit\",\n                \"Addenbrooke's Cognitive Examination Score. Scores can range from 0 to 100\",\n                \"Clinical diagnosis of cognitive impairment ('imp' = impaired, 'unimp' = unimpaired)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldecline.csv\")\n```\n\nif we don't recenter age, then the intercept variability `(1|ppt)` is estimated way back 60 years before we collected any data. The slopes will basically perfectly predicted these intercept differences, so the model will be singular.  \nre-centering will help.  \n```{r}\n#| eval: false\n#recenter age\ndf$ageC <- df$age-60\n\nmod1 <- lmer(ACE ~ 1 + ageC * condition + \n               (1 + ageC | ppt), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_mindfuldeclineFULL.csv - Multi-center Mindful Cognitive Aging<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nA large study involving 14 different research centers is interested in examining **whether engaging in mindfulness can prevent cognitive decline in older adults**. Each site recruits between 15 and 30 participants at age 60, and administer the Addenbrooke's Cognitive Examination (ACE) every 2 years (until participants were aged 78). For each center, roughly half of the participants engaged with daily mindfulness sessions, while the remaining participants did not.     \n\nData are available at [https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv](https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"Site Identifier\",\n                \"Participant Identifier\",\n                \"Whether the participant engages in mindfulness or not (control/mindfulness)\",\n                \"Visit number (1 - 10)\",\n                \"Age (years) at visit\",\n                \"Addenbrooke's Cognitive Examination Score. Scores can range from 0 to 100\",\n                \"Clinical diagnosis of cognitive impairment ('imp' = impaired, 'unimp' = unimpaired)\")\n) |> gt::gt()\n\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nas above but it's nested\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv\")\ndf$ageC <- df$age-60\n\n# maximal model won't converge\nmmod <- lmer(ACE ~ 1 + ageC * condition + \n              ( 1 + ageC * condition | sitename) +\n               (1 + ageC | sitename:ppt), \n             data = df)\n\n# probably simplify to \nmod <- lmer(ACE ~ 1 + ageC * condition + \n              ( 1 + ageC | sitename) +\n               (1 + ageC | sitename:ppt), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### stressweek1.csv - CBD drinks and stress levels: Version 1<br><span class=\"tag\">\\#longitudinal</span>\n\nSuppose that we conducted an experiment on a sample of 20 staff members from the Psychology department to investigate **effects of CBD consumption on stress over the course of the working week**. Participants were randomly allocated to one of two conditions: the control group continued as normal, and the CBD group were given one CBD drink every day. Over the course of the working week (5 days) participants stress levels were measured using a self-report questionnaire.  \n\nData are available at [https://uoepsy.github.io/data/stressweek1.csv](https://uoepsy.github.io/data/stressweek1.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\npsychstress <- read_csv(\"https://uoepsy.github.io/data/stressweek1.csv\")\ntibble(\n  variable=names(psychstress),\n  description=c(\"Department\",\n                \"Participant Name\",\n                \"Whether or not they were allocated to the control group (N) or the CBD group (Y)\",\n                \"Measure used to assess stress levels\",\n                \"Day of the working week (1 to 5)\",\n                \"Stress Level (standardised)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressweek1.csv\")\n# re-center 'day' so the intercept is day 1\ndf$day <- df$day-1 \n\nmod1 <- lmer(stress ~ 1 + day * CBD + \n               (1 + day | pid), \n             data = df)\n\nsummary(mod1)\n```\n\n`r solend()`\n\n::: {.callout-note collapse=\"true\"}\n#### stressweek_nested.csv - CBD drinks and stress levels: Version 2<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nAs for Version 1 of this study (see above), but instead of a sample of 20 participants from the psychology staff, we have 240 people from various departments such as History, Philosophy, Art, etc.. \n\nData are available at [https://uoepsy.github.io/data/stressweek_nested.csv](https://uoepsy.github.io/data/stressweek_nested.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(\n  variable=names(read_csv(\"https://uoepsy.github.io/data/stressweek_nested.csv\")),\n  description=c(\"Department\",\n                \"Participant Name\",\n                \"Whether or not they were allocated to the control group (N) or the CBD group (Y)\",\n                \"Measure used to assess stress levels\",\n                \"Day of the working week (1 to 5)\",\n                \"Stress Level (standardised)\")\n) |> gt::gt()\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressweek_nested.csv\")\n\n# re-center 'day' so the intercept is day 1\ndf$day <- df$day-1 \n\n# removed day*CBD|dept to obtain convergence\nmod1 <- lmer(stress ~ 1 + day * CBD + \n               (1 + day + CBD | dept) +\n               (1 + day | dept:pid), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n::: {.callout-note collapse=\"true\"}\n#### stressweek_crossed.csv - CBD drinks and stress levels: Version 3<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nAs for Version 1 of this study (see above), with 20 staff members from the Psychology department, but instead of taking a measurement _only_ on a self-report scale, we took 10 different measures every time point (cortisol levels, blood pressure, heart rate variability, various questionnaires etc).  \n\nData are available at [https://uoepsy.github.io/data/stressweek_crossed.csv](https://uoepsy.github.io/data/stressweek_crossed.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\ntibble(\n  variable=names(read_csv(\"https://uoepsy.github.io/data/stressweek_crossed.csv\")),\n  description=c(\"Department\",\n                \"Participant Name\",\n                \"Whether or not they were allocated to the control group (N) or the CBD group (Y)\",\n                \"Measure used to assess stress levels\",\n                \"Day of the working week (1 to 5)\",\n                \"Stress Level (standardised)\")\n) |> gt::gt()\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressweek_crossed.csv\")\n\n# re-center 'day' so the intercept is day 1\ndf$day <- df$day-1 \n\n# removed day*CBD|dept to obtain convergence\nmod1 <- lmer(stress ~ 1 + day * CBD + \n                (1 + day + CBD | measure) +\n                (1 + day | pid), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### cogdecline.csv - domain differences in cognitive aging<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nThese data are simulated to represent a large scale international study of cognitive aging, for which data from 17 research centers has been combined. The study team are interested in **whether different cognitive domains have different trajectories as people age**. Do all cognitive domains decline at the same rate? Do some decline more steeply, and some less? The literature suggests that scores on cognitive ability are predicted by educational attainment, so they would like to control for this.  \n\nEach of the 17 research centers recruited a minimum of 14 participants (Median = 21, Range 14-29) at age 48, and recorded their level of education (in years). Participants were then tested on 5 cognitive domains: processing speed, spatial visualisation, memory, reasoning, and vocabulary. Participants were contacted for follow-up on a further 9 occasions (resulting in 10 datapoints for each participant), and at every follow-up they were tested on the same 5 cognitive domains. Follow-ups were on average 3 years apart (Mean = 3, SD = 0.8). \n\nData are available at [https://uoepsy.github.io/data/cogdecline.csv](https://uoepsy.github.io/data/cogdecline.csv). \n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/cogdecline.csv\")),\n  description = c(\"Center ID\",\"Participant Identifier\",\"Educational attainment (years of education)\",\"Age at visit (years)\",\n                  \"Score on Processing Speed domain task\",\n                  \"Score on Spatial Visualisation domain task\",\n                  \"Score on Memory domain task\",\n                  \"Score on Reasoning domain task\",\n                  \"Score on Vocabulary domain task\"\n                  )\n) |> gt::gt()\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nwe need to reshape this data! we don't have a single variable \"score\" here, because it's actually split across 5 columns (one for each domain). So we reshape those columns to have a variable called \"score\" and a variable indicating which domain it is a score of (we'll call it \"domain\"):  \n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/cogdecline.csv\")\n\n# reshape\ndf <- df |> pivot_longer(processing_speed:vocabulary,\n                   names_to = \"domain\",\n                   values_to = \"score\")\n\n# recenter age and educ\ndf$age <- (df$age - 48)/5\ndf$educ <- df$educ - min(df$educ)\n```\nthis won't converge:\n```{r}\n#| eval: false\nmod1 <- lmer(score ~ educ + age * domain + \n               (1 + educ + age * domain | cID) + \n               (1 + age * domain | cID:pptID),\n             data = df)\n```\nthis will - it's using the trick of putting the domain on the RHS here, to still have different slopes of score~age for each domain:  \n```{r}\n#| eval: false\nmod1 <- lmer(score ~ educ + age * domain + \n               (1 | cID) + \n               (1 + age | cID:pptID) +\n               (1 + age | cID:pptID:domain),\n             data = df,\n             control=lmerControl(optimizer=\"bobyqa\"))\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_gadeduc.csv - Psychoeducation treatment effects<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n```{r}\n#| include: false\ngeduc = read_csv(\"https://uoepsy.github.io/data/lmm_gadeduc.csv\")\ngeduc1 = geduc |> \n  pivot_longer(2:last_col(), names_to=\"visit\",values_to=\"GAD\") |>\n  mutate(\n    visit = as.numeric(gsub(\"visit_\",\"\",visit))\n  ) |>\n  separate(patient, into=c(\"therapist\",\"group\",\"patient\"), sep=\"_\")\n# m = lmer(GAD~visit*group+(1+visit*group|therapist)+(1+visit|therapist:patient),geduc1)\n# summary(m)\ntn = geduc1 |> group_by(therapist) |> summarise(np = n_distinct(patient))\n```\n\nThis is synthetic data from a randomised controlled trial to **evaluate the efficacy of a psychoeducational treatment on anxiety disorders**, in which `r nrow(tn)` therapists randomly assigned patients (each therapist saw between `r min(tn[,'np'])` and `r max(tn[,'np'])` patients) to a control or treatment group, and monitored their scores over time on a measure of generalised anxiety disorder (GAD7 - a 7 item questionnaire with 5 point likert scales).  \n\nThe control group of patients received standard sessions offered by the therapists. \nFor the treatment group, 10 mins of each sessions was replaced with a specific psychoeducational component, and patients were given relevant tasks to complete between each session. All patients had monthly therapy sessions. Generalised Anxiety Disorder was assessed at baseline and then every visit over 4 months of sessions (5 assessments in total).  \n\nData are available at [https://uoepsy.github.io/data/lmm_gadeduc.csv](https://uoepsy.github.io/data/lmm_gadeduc.csv){target=\"_blank\"}\n\nYou can find a data dictionary below:\n```{r}\n#| echo: false\ntibble(\n    variable = names(geduc),\n    description = c(\"A patient code in which the labels take the form <Therapist initials>_<group>_<patient number>.\",\"Score on the GAD7 at baseline\", \n                    \"GAD7 at 1 month assessment\",\n                    \"GAD7 at 2 month assessment\",\n                    \"GAD7 at 3 month assessment\",\n                    \"GAD7 at 4 month assessment\"\n                    )\n)  |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nthis one needs lots of reshaping and sorting out first, but it can actually be done with minimal code using things like `separate()`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_gadeduc.csv\")\ndf <- df |> \n  pivot_longer(2:last_col(), names_to=\"visit\",values_to=\"GAD\") |>\n  mutate(\n    visit = as.numeric(gsub(\"visit_\",\"\",visit))\n  ) |>\n  separate(patient, into=c(\"therapist\",\"group\",\"patient\"), sep=\"_\")\n\nmod <- lmer(GAD~ visit*group+ \n              (1+visit*group|therapist)+\n              (1+visit|therapist:patient),\n            df)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n### abs_intervention.csv - evaluating an intervention to reduce adolescent aggressive behaviours<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nIn 2010 A US state's commissioner for education was faced with growing community concern about rising levels of adolescent antisocial behaviours. \n\nAfter a series of focus groups, the commissioner approved the trialing of an intervention in which yearly Parent Management Training (PMT) group sessions were offered to the parents of a cohort of students entering 10 different high schools. Every year, the parents were asked to fill out an informant-based version of the Aggressive Behaviour Scale (ABS), measuring verbal and physical abuse, socially inappropriate behavior, and resisting care. Where possible, the same parents were followed up throughout the child's progression through high school. Alongside this, parents from a cohort of students entering 10 further high schools in the state were recruited to also complete the same informant-based ABS, but were not offered the PMT group sessions.  \nThe commissioner has two main questions: **Does the presentation of aggressive behaviours increase as children enter the secondary school system? Is there any evidence for the effectiveness of Parent Management Training (PMT) group sessions in curbing the rise of aggressive behaviors during a child's transition into the secondary school system?**  \n\nData are available at [https://uoepsy.github.io/data/abs_intervention.csv](https://uoepsy.github.io/data/abs_intervention.csv) \n\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/abs_intervention.csv\")\ntibble(variable=names(d3),\n       description = c(\n         \"School Name\",\n         \"Participant Identifier\",\n         \"Age (years)\",\n         \"Whether or not parents attended Parent Management Training (PMT) group sessions (0 = No, 1 = Yes)\",\n         \"Aggressive Behaviours Scale. Measures verbal and physical abuse, socially inappropriate behavior, and resisting care. Scores range from 0 to 100, with higher scores indicating more aggressive behaviours.\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nCheck here: [https://uoepsy.github.io/dapr3/2425/lectures/05recap.html#/the-research-process-model-specification ](https://uoepsy.github.io/dapr3/2425/lectures/05recap.html#/the-research-process-model-specification ){target=\"_blank\"}\n\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n### lmm_laughs.csv - the visual aspect of humour<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n```{r}\n#| include: false\nlaughs <- read_csv(\"https://uoepsy.github.io/data/lmm_laughs.csv\")\n```\n\nThese data are simulated to imitate an experiment that investigates the effect of visual non-verbal communication (i.e. gestures, facial expressions) on joke appreciation. \n`r n_distinct(laughs$ppt)` Participants took part in the experiment, in which they each rated how funny they found a set of `r n_distinct(laughs$joke_id)` jokes. For each participant, the order of these `r n_distinct(laughs$joke_id)` jokes was randomly set for each run of the experiment. For each participant, the set of jokes was randomly split into two halves, with the first half being presented in audio-only, and the second half being presented in audio and video. This meant that each participant saw `r n_distinct(laughs$joke_id)/2` jokes with video and `r n_distinct(laughs$joke_id)/2` without, and each joke would be presented in with video roughly half of the times it was seen.  \n\nThe researchers want to investigate **whether the delivery (audio/audiovideo) of jokes is associated with differences in humour-ratings.**  \n\nData are available at [https://uoepsy.github.io/data/lmm_laughs.csv](https://uoepsy.github.io/data/lmm_laughs.csv)\n\n```{r}\n#| echo: false\n#| label: tbl-laughdict\n#| tbl-cap: \"Data Dictionary: lmm_laughs.csv\"\ntibble(\n  variable = names(laughs),\n  description = c(\"Participant Identification Number\",\n                  \"Joke presented\",\n                  \"Joke Identification Number\",\n                  \"Experimental manipulation: whether joke was presented in audio-only ('audio') or in audiovideo ('video')\",\n                  \"Humour rating chosen on a slider from 0 to 100\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_laughs.csv\")\n\nmod <- lmer(rating ~ delivery + \n              (1 + delivery | joke_id) +\n              (1 + delivery | ppt),\n            data = df)\n```\n\nworth looking at random effects for different jokes to see which ones are funniest etc.  \nThe jokes are all from some study 10 years ago that aimed to find \"the worlds funniest joke\"  \n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n### NGV.csv - Video game aggression and the dark triad<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nThese data are from an experiment designed to investigate **how the realism of video games is associated with more/less unnecessarily aggressive gameplay, and whether this differs depending upon a) the playing mode (playing on a screen vs VR headset), and b) individual differences in the 'dark triad' personality traits.**  \n\nThe experiment involved playing 10 levels of a game in which the objective was to escape a maze. Various obstacles and other characters were present throughout the maze, and players could interact with these by side-stepping or jumping over them, or by pushing or shooting at them. All of these actions took the same amount of effort to complete (pressing a button), and each one achieved the same end (moving beyond the obstacle and being able to continue through the maze).  \n\nEach participant completed all 10 levels twice, once in which all characters were presented as cartoons, and once in which all characters were presented as realistic humans and animals. The layout of the level was identical in both, the only difference being the depiction of objects and characters. For each participant, these 20 levels ($2 \\times 10$ mazes) were presented in a random order. Half of the participants played via a screen, and the other half played via a VR headset. For each level played, we have a record of \"needless game violence\" (NGV) which was calculated via the number of aggressive (pushing/shooting) actions taken (+0.5 for every action that missed an object, +1 for every action aimed at an inanimate object, and +2 for every action aimed at an animate character).  \nPrior to the experiment, each participant completed the Short Dark Triad 3 (SD-3), which measures the three traits of machiavellianism, narcissism, and psychopathy.  \n\nData are available at [https://uoepsy.github.io/data/NGV.csv](https://uoepsy.github.io/data/NGV.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\nngv <- read_csv(\"../../data/NGV.csv\")\ntibble(\n  variable=names(ngv),\n  description=c(\n    \"Participant number\",\n    \"Participant age (years)\",\n    \"Maze level (1 to 20)\",\n    \"Whether the objects and characters in the level were presented as 'cartoon' or as 'realistic'\",\n    \"Whether the participant played via a screen or with a VR headset\",\n    \"Psycopathy Trait from SD-3 (score 1-5)\",\n    \"Narcissism Trait from SD-3 (score 1-5)\",\n    \"Machiavellianism Trait from SD-3 (score 1-5)\",\n    \"Needless Game Violence metric\"\n  )\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n_(you could also try to fit the interactions in the random effects here but i'm not going to even try!)_  \n```{r}\n#| eval: false\nm0 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + character + mode + P + M + N | level), data = ngv)\n```\n\nafter some simplification, I end up at the model below. You might end up at a slightly different random effect structure, and that is completely okay! The important thing is to be transparent in your decisions.  \n```{r}\n#| eval: false\nm1 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + mode | level), data = ngv)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### erm_belief.csv - erm.. I don't believe you<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n\nThese data are simulated to represent data from 30 participants who took part in an experiment designed to investigate **whether fluency of speech influences how believable an utterance is perceived to be**.  \n\nEach participant listened to the same 20 statements, with 10 being presented in fluent speech, and 10 being presented with a disfluency (an \"erm, ...\"). Fluency of the statements was counterbalanced such that 15 participants heard statements 1 to 10 as fluent and 11 to 20 as disfluent, and the remaining 15 participants heard statements 1 to 10 as disfluent, and 11 to 20 as fluent. The order of the statements presented to each participant was random. Participants rated each statement on how believable it is on a scale of 0 to 100.  \n\nData are available at [https://uoepsy.github.io/data/erm_belief.csv](https://uoepsy.github.io/data/erm_belief.csv). \n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/erm_belief.csv\")),\n  description = c(\"Participant Identifier\",\"Trial number\", \"Statement identifier\", \"Condition (fluent v disfluent)\", \"belief rating (0-100)\", \"Statement\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/erm_belief.csv\")\n# make trial_n numeric\ndf$trial_n <- as.numeric(gsub(\"trial_\",\"\",df$trial_n))\n# relevel condition:\ndf$condition <- factor(df$condition, levels=c(\"fluent\",\"disfluent\"))\n\n# having (trial_n | ppt) doesn't converge, so simplify to:\nmod1 <- lmer(belief ~ trial_n + condition + \n               (1 | ppt) + \n               (1 + condition | statement), \n             data = df)\n\nsummary(mod1)\n```\n\neaster egg: plot your ranefs\n```{r}\n#| eval: false\ndotplot.ranef.mer(ranef(mod1))$statement\n```\n\n\n`r solend()`\n\n\n\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_alcgad.csv - relative levels of anxiety and alcohol use<br><span class=\"tag\">\\#repeated-measures</span>\n\nA research study is investigating **how anxiety is associated with drinking habits**. Data was collected from 50 participants from 5 centers. Researchers administered the generalised anxiety disorder (GAD-7) questionnaire to measure levels of anxiety over the past week, and collected information on the units of alcohol participants had consumed within the week. Each participant was observed on 10 different occasions. \n\nThe researchers are also interested in testing an intervention (given to half of the participants) - they want to know if this changes the association between anxiety and alcohol consumption.  \n\n```{r}\n#| echo: false\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/lmm_alcgad.csv\")),\n  description = c(\n    \"Number of units of alcohol consumed over the past week\",\n    \"Score on the Generalised Anxiety Disorder scale (scores 0-3 on 7 questions are totalled for an overall score)\",\n    \"Whether the participant is part of the intervention group (1) or not (0)\",\n    \"Center ID\",\n    \"Participant ID\"\n    )\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nWe actually have participants nested in center here, but there are only 5 centers.. \n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_alcgad.csv\")\n\n```\nfirst though, we'll calculate ppt means and ppt deviations-from-means\n```{r}\n#| eval: false\ndf <- df |> \n  group_by(ppt) |>\n  mutate(\n    gadm = mean(gad),\n    gaddev = gad - mean(gad)\n  ) |> ungroup()\n```\n\nthis works, but bear in mind we do only have 5 centers.. \n```{r}\n#| eval: false\nmod <- lmer(alcunits ~ gadm + gaddev + \n       (1 + gaddev | center) +\n       (1 + gaddev | center:ppt),\n     df)\n```\nthis would be defensible too:  \n```{r}\n#| eval: false\nmod <- lmer(alcunits ~ center + gadm + gaddev + \n       (1 + gaddev | ppt),\n     df)\n```\n\nWe also have the intervention question, which to meet convergence might need to do something like: \n```{r}\n#| eval: false\nmod <- lmer(alcunits ~ center + (gadm + gaddev)*intervention + \n       (1 | ppt),\n     df)\n```\n`r solend()`\n\n\n::: {.callout-note collapse=\"true\"}\n#### dapr3_tgu.csv - Physiotherapy and physical functioning <br><span class=\"tag\">\\#repeated-measures</span>\n\n```{r}\n#| eval: false\n#| echo: false\nlibrary(lme4)\nset.seed(86)\ndoit<-1\nwhile(doit){\n  Ngroup2s = 10\n  dd2<-MASS::mvrnorm(n=Ngroup2s, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n  cor(dd2)\n  i = 2\n  df<-as.data.frame(c())\n  for(i in 1:Ngroup2s){\n    Ngroups = round(rnorm(1,10,0))\n    Nxgroups = 2\n    \n    #NperGroup = rep(Nxgroups*nrep,Ngroups)\n    NperGroup = rdunif(Ngroups, 5, 10)*Nxgroups\n    N = sum(NperGroup)\n    \n    dd<-MASS::mvrnorm(n=Ngroups, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n    ddb<-MASS::mvrnorm(n=Ngroups, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n    ddx<-MASS::mvrnorm(n=Nxgroups, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n    \n    igs = map(seq_along(NperGroup), ~rep(.,NperGroup[.])) %>% unlist\n    xgs = map(1:Ngroups, ~rep(1:Nxgroups,NperGroup[.]/Nxgroups)) %>% unlist\n    #x = map(1:Ngroups, ~rep(1:NperGroup[.],Nxgroups)) %>% unlist\n    xxm = rnorm(Ngroups,50,10)\n    xxm = map(1:Ngroups, ~rep(xxm[.], NperGroup[.])) %>% unlist\n    xgc = map(1:Ngroups, ~rnorm(NperGroup[.], 0, 3)) %>% unlist\n    #xx = map(1:Ngroups, ~rep(rnorm(1,3,.6), NperGroup[.]))%>% unlist\n    xx = xxm+xgc \n    \n    l2p = sample(1:4, Ngroups, replace=T, prob = c(.2,.5,.3,.1))\n    l2p = map(1:Ngroups, ~rep(l2p[.], NperGroup[.])) %>% unlist\n    \n    l3p = i %% 2\n    e = rnorm(N, sd = 15)\n    \n    y = 0 +\n      dd[igs,1]+\n      dd2[i,1]+\n      #ddx[xgs, 1] + \n      -5*xxm+\n      #-.05*(xx2 %in% c(1,2,4))*xgc+\n      -6*xgc + \n      dd[igs,2]*xgc +\n      #ddb[igs,2]*xxm + \n      1*dd2[i,2]*xxm +\n      -3*l2p + \n      2*l3p +\n      e\n    d = data.frame(y,xxm,xgc,igs,xgs,i, l2p,l3p)\n    #ggplot(d,aes(x=x,y=y,group=factor(igs)))+facet_wrap(~xgs)+geom_path()\n    d$ng2 = i\n    df<-rbind(df,d)\n  }\n  df %>% filter(xgs == 1) %>%\n  lmer(y ~ xxm + xgc + l2p + l3p + (1+xgc | ng2/igs), data =.,\n       control=lmerControl(optimizer = \"bobyqa\")) -> m \n  print(VarCorr(m))\n  t1 = attributes(VarCorr(m)[[1]])$stddev\n  t2 = attributes(VarCorr(m)[[1]])$correlation\n  t3 = attributes(VarCorr(m)[[2]])$stddev\n  t4 = attributes(VarCorr(m)[[2]])$correlation\n  \n  if(!isSingular(m) & all(t1 != 0) & !(t2[lower.tri(t2)] %in% c(0,1,-1)) & all(t3 != 0) & !(t4[lower.tri(t4)] %in% c(0,1,-1)) ){\n    doit <- 0\n  }\n}\n\ndf %>% filter(xgs==1) %>% transmute(\n  tgu = 8+(scale(y)[,1]*4),\n  phys = round(xxm + xgc),\n  hospital = ng2,\n  patient = igs,\n  prioritylevel = l2p,\n  private = l3p\n) %>% filter(hospital%in%c(5,6)) %>% \n  mutate(hospital=paste0(\"Hospital_\",hospital),\npatient = paste0(hospital,patient))-> tgudat\n\n#write_csv(tgudat, \"../../data/dapr3_tgu.csv\")\n```\n\nA researcher is interested in the efficacy of physiotherapy in helping people to regain normal physical functioning. They are curious **whether doing more physiotherapy leads to better outcomes, or if it is possibly that the patients who tend to do more of their exercises tend to have better outcomes**. 20 in-patients from 2 different hospitals (1 private, 1 govt funded) were monitored over the course of their recovery following knee-surgery. Every day, the time each patient spent doing their physiotherapy exercises was recorded. At the end of each day, participants completed the \"Time get up and go\" task, a measure of physical functioning.  \n\nData are available at [https://uoepsy.github.io/data/dapr3_tgu.csv](https://uoepsy.github.io/data/dapr3_tgu.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/dapr3_tgu.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\n    \"Time Get up and Go Task - measure of physical functioning. Scored in minutes, with lower scores indicating better physical functioning\",\n    \"Minutes of physiotherapy exercises completed that day\",\n    \"Hospital ID\",\n    \"Patient ID\",\n    \"Priority level of patients' surgery (rank 1-4, with 1 being most urgent surgey, and 4 being least urgent)\",\n    \"0 = government funded hospital, 1 = private hospital\"\n  )\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\npatients are nested in hospitals, but there are only 2 hospitals!  \njust shove it in as fixed predictor\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/dapr3_tgu.csv\")\n\ndf <- df |> group_by(patient) |>\n  mutate(\n    physm = mean(phys),\n    physdev = phys - mean(phys)\n  ) |> ungroup()\n\nmod <- lmer(tgu ~ hospital + physm + physdev + \n              (1 + physdev | patient),\n            data = df)\n```\n`r solend()`\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_bflpe.csv - big fish little pond <br><span class=\"tag\">\\#cross-sectional</span>\n\n```{r}\n#| echo: false\nbfdat <- read_csv(\"https://uoepsy.github.io/data/lmm_bflpe.csv\")\n```\n\n\nThese data are simulated based on the [\"Big-fish-little-pond\" effect](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6124391/){target=\"_blank\"} in educational literature. \n\nWe are interested in better understanding the relationship between school children's grades and their academic self-concept (their self-perception of ability in specific and general academic disciplines).  \n\nWe have data from `r n_distinct(bfdat$class)` classes of children, capturing information on their grades at school (range 0 to 10), and a measure of academic self-concept:  \n\nData are available at  [https://uoepsy.github.io/data/lmm_bflpe.csv](https://uoepsy.github.io/data/lmm_bflpe.csv)  \n\n```{r}\n#| echo: false\nbfdat <- read_csv(\"https://uoepsy.github.io/data/lmm_bflpe.csv\")\ntibble(\n  variable = names(bfdat),\n  description = c(\"Children's School Grade\",\n                  \"Class Identifier\",\n                  \"Children's Self-Concept Score\",\n                  \"Child Identifier\")\n) |> gt::gt()\n```\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_bflpe.csv\")\n\ndf <- df |> group_by(class) |>\n  mutate(\n    gradem = mean(grade),\n    gradedev = grade - mean(grade)\n  )\n\nmod <- lmer(self_concept ~ gradem + gradedev + \n              (1 + gradedev | class), \n            data = df)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### hangry.csv - hunger + anger = hanger<br><span class=\"tag\">\\#cross-sectional</span>\n\nThis study is interested in evaluating **whether peoples' hunger levels are associated with their levels of irritability** (i.e., \"the hangry hypothesis\"), and if this differs between people on a diet vs those who aren't. 81 participants were recruited into the study. Once a week for 5 consecutive weeks, participants were asked to complete two questionnaires, one assessing their level of hunger, and one assessing their level of irritability. The time and day at which participants were assessed was at a randomly chosen hour between 7am and 7pm each week. 46 of the participants were following a five-two diet (five days of normal eating, 2 days of fasting), and the remaining 35 were following no specific diet.  \n\nData are available at  [https://uoepsy.github.io/data/hangry.csv](https://uoepsy.github.io/data/hangry.csv)  \n\n```{r}\n#| echo: false\nhangry<-read_csv(\"https://uoepsy.github.io/data/hangry.csv\") %>% mutate(fivetwo=factor(fivetwo))\ntibble(\n    variable = names(hangry),\n    description = c(\"Score on irritability questionnaire (0:100)\",\n                    \"Score on hunger questionnaire (0:100)\",\n                    \"Participant Identifier\",\n                    \"Whether the participant follows the five-two diet\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/hangry.csv\")\n\ndf <- df |> group_by(ppt) |>\n  mutate(\n    hungerm = mean(q_hunger),\n    hungerdev = q_hunger - mean(q_hunger)\n  )\n\nmod <- lmer(q_irritability ~ (hungerm + hungerdev) * fivetwo +\n              (1 + hungerdev | ppt), \n            data = df,\n            control=lmerControl(optimizer=\"bobyqa\"))\n\n```\n`r solend()`\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### pvt_bilingual.csv - Vocabulary development in monolingual and bilingual children<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#non-linear</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n```{r}\n#| echo: false\npvt <- read_csv(\"https://uoepsy.github.io/data/pvt_bilingual.csv\")\npvtsc = pvt |> count(school,child,isBilingual)\n```\n\n`r nrow(pvtsc)` children from `r length(unique(pvt$school))` schools were included in the study. Children were assessed on a yearly basis for 7 years throughout primary school on a measure of vocabulary administered in English, the Picture Vocab Test (PVT). `r sum(pvtsc$isBilingual==0)` were monolingual English speakers, and `r sum(pvtsc$isBilingual==1)` were bilingual (english + another language). \n\nPrevious research conducted on monolingual children has suggested that that scores on the PVT increase steadily up until the age of approximately 7 or 8 at which point they begin to plateau. The aim of the present study is to **investigate differences in the development of vocabulary between monolingual and bilingual children.**  \n\nData are available at [https://uoepsy.github.io/data/pvt_bilingual.csv](https://uoepsy.github.io/data/pvt_bilingual.csv).  \n\n```{r}\n#| echo: false\ntibble(variable = names(pvt),\n       description = c(\n         \"Child's name\",\n         \"School Identifier\",\n         \"Binary variable indicating whether the child is monolingual (0) or bilingual (1)\",\n         \"Age (years)\",\n         \"Score on the Picture Vocab Test (PVT). Scores range 0 to 60\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nLet's read in the data:  \n```{r}\npvt <- read_csv(\"https://uoepsy.github.io/data/pvt_bilingual.csv\")\n```\n\nWe have 30 distinct schools:\n```{r}\nn_distinct(pvt$school)\n```\n\nAnd 418 distinct children. Is that right?  \n```{r}\nn_distinct(pvt$child)\n```\n\nGiven that the `pvt$child` variable is just the first name of the child, it's entirely likely that there will be, for instance more than one \"Martin\".  \n\nThis says that there are 487!  \n```{r}\npvt |> count(school, child) |> nrow()\n```\n\nBut wait... we could _still_ have issues. What if there were 2 \"Martin\"s at the same school??\n```{r}\n\npvt |> \n  # count the school-children groups\n  count(school, child) |> \n  # arrange the output so that the highest \n  # values of the 'n' column are at the top\n  arrange(desc(n))\n```\n\nAha! There are 7 cases where schools have two children of the same name. Remember that each child was measured at 7 timepoints. We shouldn't have people with 14!  \n\nIf we actually _look_ at the data, we'll see that it is very neatly organised, with each child's data together. This means that we could feasibly make an educated guess that, e.g., the \"Jackson\" from \"School 3\" in rows 155-161 is different from the \"Jackson\" from \"School 3\" at rows 190-196. \n\nBecause of the ordering of our data, we can do something like this:  \n```{r}\npvt <- \n  pvt |>\n  # group by the school and child\n  group_by(school, child) |>\n  mutate(\n    # make a new variable which counts from 1 to \n    # the number of rows for each school-child\n    n_obs = 1:n()\n  ) |>\n  # ungroup the data\n  ungroup() |>\n  mutate(\n    # change it so that if the n_obs is >7, the \n    # child becomes \"[name] 2\", to indicate they're the second\n    # child with that name\n    child = ifelse(n_obs>7, paste0(child,\" 2\"), child)\n  )\n```\n\nNow we have 494!  \n```{r}\npvt |> count(school, child) |> nrow()\n```\n\nAnd nobody has anything other than 7 observations!\n```{r}\npvt |> count(school, child) |>\n  filter(n != 7)\n```\n\nPhew!  \n\nOkay, let's just fit an intercept-only model:  \n```{r}\npvt_null <- lmer(PVT ~ 1 +  (1 | school/child), data = pvt)\nsummary(pvt_null)\n```\n\n```{r}\n#| echo: false\nvcres = VarCorr(pvt_null) |> as.data.frame()\nvcres = round(vcres$vcov,2)\n```\n\n\nAs we can see from `summary(bnt_null)`, the random intercept variances are `r vcres[1]` for child-level, `r vcres[2]` for school-level, and the residual variance is `r vcres[3]`.\n\nSo child level differences account for $\\frac{`r vcres[1]`}{`r paste0(vcres,collapse=\" + \")`} = `r round(vcres[1]/sum(vcres),2)`$ of the variance in PVT scores, and child & school differences together account for $\\frac{`r paste0(vcres[1:2],collapse=\" + \")`}{`r paste0(vcres,collapse=\" + \")`} = `r round(sum(vcres[1:2])/sum(vcres),2)`$ of the variance.\n\nHere's an initial plot too:\n\n```{r}\nggplot(pvt, aes(x=age,y=PVT,col=factor(isBilingual)))+\n  stat_summary(geom=\"pointrange\")+\n  stat_summary(geom=\"line\")\n```\n\nI feel like either raw or orthogonal polynomials would be fine here - there's nothing explicit from the study background about stuff \"at baseline\". There's the stuff about the plateau at 7 or 8, but we can get that from the model plots. Orthogonal will allow us to compare the trajectories overall (their linear trend, the 'curviness' and 'wiggliness').  \n\nAn additional benefit of orthogonal polynomials is that we are less likely to get singular fits when we include polynomial terms in our random effects. Remember, raw polynomials are correlated, so often the by-participant variances in raw poly terms are highly correlated. \n\nI've gone for 3 degrees of polynomials here because the plot above shows a bit of an S-shape for the bilinguals. \n\n```{r}\npvt <- pvt |> mutate(\n  poly1 = poly(age, 3)[,1],\n  poly2 = poly(age, 3)[,2],\n  poly3 = poly(age, 3)[,3],\n  isBilingual = factor(isBilingual)\n)\n```\n\nThese models do not converge.  \nI've tried to preserve the by-child random effects of time, because while I think Schools probably _do_ vary, School's all teach the same curriculum, whereas there's _a lot_ of varied things that can influence a child's vocabulary, both in and out of school  \n```{r}\n#| eval: false\nmod1 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + (poly1 + poly2 + poly3)*isBilingual | school) + \n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod2 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual * (poly1 + poly2) + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod3 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual * poly1 + poly2 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod4 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual + poly1 + poly2 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod5 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n# relative to the variance in time slopes, there's v little by-school variance in bilingual differences in vocab\n\nmod6 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly2 +  poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n# looks like curvature doesn't vary between schools much as linear and wiggliness \n```\n\nthis one does! \n```{r}\nmod7 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n```\n\n\n```{r}\nlibrary(broom.mixed)\naugment(mod7) |> \n  mutate(\n    poly1 = round(poly1, 3) # because of rounding errors that make plot weird\n  ) |>\n  ggplot(aes(x=poly1,col=isBilingual))+\n  stat_summary(geom=\"pointrange\",aes(y=PVT))+\n  stat_summary(geom=\"line\", aes(y=.fitted))\n```\n\nrefitted with lmerTest:  \n```{r}\nmod7 <- lmerTest::lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nsummary(mod7)\n```\n\n```{r}\n#| echo: false\nmm <- lmerTest::lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\ntidy(mm) |> filter(effect==\"fixed\") |> transmute(\n  term,\n  est = round(estimate,2),\n  p = ifelse(p.value<.05,\"*\",\"\"),\n  interpretation = c(\n    \"average vocab score at the mean age (for monolingual)\",\n    \"vocab increases over time (for monolingual children)\",\n    \"the increase in vocab becomes more gradual (for monolingual children)\",\n    \"no significant wiggliness to vocab trajectory of the average monolingual child\",\n    \"average vocab score at mean age is lower for bilingual vs monolingual children\",\n    \"no significant difference in linear trend of vocab for bilingual vs monolingual\",\n    \"curvature for vocab trajectory of bilingual children significantly differs from that of monolinguals\",\n    \"wiggliness for vocab trajectory of bilingual children significantly differs from that of monolinguals\"\n  )\n) |> gt::gt()\n```\n\nFrom the random effects, we get even more information!  \nSchool's vary in the average child vocab score at mean age with an SD of 4.5.  More school level variation in linear trends than in curvature. Schools with higher vocab scores at the mean age tend to have lower linear increase, and also a more negative curvature.  \nWithin schools, children vary in the vocab scores at mean age with an SD of 5.9. Lots of child-level variation in curvature and linear increases, slightly less variation in wiggliness. \n\n```{r}\nVarCorr(mod7)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### Az.rda - trajectories of memory, simple, and complex daily functioning tasks in patients with Alzheimer's<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#non-linear</span>\n  \nThese data are available at [https://uoepsy.github.io/data/Az.rda](https://uoepsy.github.io/data/Az.rda). You can load the dataset using:  \n```{r}\nload(url(\"https://uoepsy.github.io/data/Az.rda\"))\n```\nand you will find the `Az` object in your environment.  \n\nThe `Az` object contains information on 30 Participants with probable Alzheimer's Disease, who completed 3 tasks over 10 time points: A memory task, and two scales investigating ability to undertake complex activities of daily living (cADL) and simple activities of daily living (sADL). Performance on all of tasks was calculated as a percentage of total possible score, thereby ranging from 0 to 100. \n\nWe're interested in **whether performance on these tasks differed at the outset of the study, and if they differed in their subsequent change in performance**.  \n\n```{r}\n#| echo: false\ntibble(\n    variable = names(Az),\n    description = c(\"Unique Subject Identifier\",\"Time point of the study (1 to 10)\",\"Task type (Memory, cADL, sADL)\",\"Score on test (range 0 to 100)\")\n) |> gt::gt()\n```\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### midlifeape.csv - mid-life happiness slump in great apes<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#non-linear</span>\n\n```{r}\n#| include: false\ndf <- read_csv(\"https://uoepsy.github.io/data/midlife_ape.csv\")\n```\n\nPrevious research has evidenced a notable dip in happiness for middle-aged humans. Interestingly, this phenomenon has even been observed in other primates, such as chimpanzees.  \n\nThe present study is interested in examining **whether the 'middle-age slump' happens to a similar extent for Orangutans as it does for Chimpanzees.** \n\n`r n_distinct(df$apeID)` apes (`r n_distinct(df$apeID[df$species==\"chimp\"])` Chimps and `r n_distinct(df$apeID[df$species==\"orangutan\"])` Orangutans) were included in the study. All apes were studied from early adulthood (10-12 years old for most great apes), and researchers administered the Happiness in Primates (HiP) scale to each participant every 3 years, up until the age of 40.  \n\nData are available at [https://uoepsy.github.io/data/midlife_ape.csv](https://uoepsy.github.io/data/midlife_ape.csv){target=\"_blank\"}.  \n\nThe dataset has already been cleaned, and the researchers have confirmed that it includes `r n_distinct(df$apeID[df$species==\"chimp\"])` Chimps and `r n_distinct(df$apeID[df$species==\"orangutan\"])` Orangutans, and every ape has complete data (i.e. 10 rows for each ape).  \n\n```{r}\n#| echo: false\nmlape <- read_csv(\"https://uoepsy.github.io/data/midlife_ape.csv\")\ntibble(\n  variable=names(mlape),\n  description=c(\"Ape's Name (all names are chosen to be unique)\",\n                \"Age (in years) at assessment\",\n                \"Species (chimp v orangutan)\",\n                \"Happiness in Primate Scale (range 1 to 18)\",\n                \"Study visit (1 to 10)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/midlife_ape.csv\")\n\n# add polynomials\ndf <- df |> \n  mutate(\n    poly1 = poly(timepoint,2,raw=F)[,1],\n    poly2 = poly(timepoint,2,raw=F)[,2]\n  )\n\nmod1 = lmer(HiP ~ 1 + (poly1 + poly2) * species +\n            (1 + poly1 + poly2 | apeID), \n            data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### memorytap.csv - Memory Recall & Finger Tapping<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#binomial-outcome</span>\n\nResearchers are interested in investigating **whether, after accounting for effects of sentence length, rhythmic tapping of fingers aids memory recall.** They recruited 40 participants. Each participant was tasked with studying and then recalling 10 randomly generated sentences between 1 and 14 words long. For 5 of these sentences, participants were asked to tap their fingers along with speaking the sentence in both the study period and in the recall period. For the remaining 5 sentences, participants were asked to sit still.  \n\nData are available at [https://uoepsy.github.io/data/memorytap.csv](https://uoepsy.github.io/data/memorytap.csv), and contains information on the length (in words) of each sentence, the condition (static vs tapping) under which it was studied and recalled, and whether the participant was correct in recalling it.  \n\n```{r}\n#| echo: false\nmemtap <- read_csv(\"https://uoepsy.github.io/data/memorytap.csv\")\ntibble(\n  variable = names(memtap),\n  description = c(\"Participant Identifier (n=40)\",\"Number of words in sentence\",\"Condition under which sentence is studied and recalled ('static' = sitting still, 'tap' = tapping fingers along to sentence)\",\"Whether or not the sentence was correctly recalled\")\n) %>% gt::gt()\n```\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### nwl.RData - novel word learning<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#binomial-outcome</span>\n\nData are available at\n```{r}\nload(url(\"https://uoepsy.github.io/msmr/data/nwl.RData\"))\n```\n\nIn the `nwl` data set (accessed using the code above), participants with aphasia are separated into two groups based on the general location of their brain lesion: anterior vs. posterior. There is data on the numbers of correct and incorrect responses participants gave in each of a series of experimental blocks. There were 7 learning blocks, immediately followed by a test. Finally, participants also completed a follow-up test. Data were also collect from healthy controls. \n<br>\nOur broader research aim today is to **compare the two lesion location groups (those with anterior vs. posterior lesions) with respect to their accuracy of responses over the course of the study.**  \n<br>\n@fig-nwl shows the differences between lesion location groups in the average proportion of correct responses at each point in time (i.e., each block, test, and follow-up)\n\n```{r}\n#| label: fig-nwl\n#| echo: false\n#| fig.cap: \"Differences between groups in the average proportion of correct responses at each block\"\nload(url(\"https://uoepsy.github.io/msmr/data/nwl.RData\"))\nggplot(filter(nwl, !is.na(lesion_location)), aes(block, PropCorrect, \n                                            color=lesion_location, \n                                            shape=lesion_location)) +\n  #geom_line(aes(group=ID),alpha=.2) + \n  stat_summary(fun.data=mean_se, geom=\"pointrange\") + \n  stat_summary(data=filter(nwl, !is.na(lesion_location), block <= 7), \n                           fun=mean, geom=\"line\") + \n  geom_hline(yintercept=0.5, linetype=\"dashed\") + \n  geom_vline(xintercept=c(7.5, 8.5), linetype=\"dashed\") + \n  scale_x_continuous(breaks=1:9, labels=c(1:7, \"Test\", \"Follow-Up\")) + \n  theme_bw(base_size=10) + \n  labs(x=\"Block\", y=\"Proportion Correct\", shape=\"Lesion\\nLocation\", color=\"Lesion\\nLocation\")\n```\n\n```{r}\n#| echo: false\ndata.frame(\n  variable = names(nwl),\n  description = c(\"Whether participant is a stroke patient ('patient') or a healthy control ('control')\", \"Location of brain lesion: anterior vs posterior\",\"Experimental block (1-9). Blocks 1-7 were learning blocks, immediately followed by a test in block 8. Block 9 was a follow-up test at a later point\",\"Proportion of 30 responses in a given block that the participant got correct\",\"Number of responses (out of 30) in a given block that the participant got correct\",\"Number of responses (out of 30) in a given block that the participant got incorrect\",\"Participant Identifier\",\"Experimental phase, corresponding to experimental block(s): 'Learning', 'Immediate','Follow-up'\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### testenhancedlearning.RData<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span><span class=\"tag\">\\#binomial-outcome</span>\n\nAn experiment was run to conceptually replicate \"test-enhanced learning\" (Roediger & Karpicke, 2006): two groups of 25 participants were presented with material to learn. One group studied the material twice (`StudyStudy`), the other group studied the material once then did a test (`StudyTest`). Recall was tested immediately (one minute) after the learning session and one week later. The recall tests were composed of 175 items identified by a keyword (`Test_word`). \n\n**The critical (replication) prediction is that the `StudyStudy` group perform better on the immediate test, but the `StudyTest` group will retain the material better and thus perform better on the 1-week follow-up test.**  \n\nWe have two options for how we measure \"test performance\":  \n\nA) The time taken to *correctly* recall a given word.  \nB) Whether or not a given word was correctly recalled\n\nThe following code loads the data into your R environment by creating a variable called `tel`:\n\n```{r}\n#| eval: false\nload(url(\"https://uoepsy.github.io/data/testenhancedlearning.RData\"))\n```\n\n```{r} \n#| echo: false\nload(url(\"https://uoepsy.github.io/data/testenhancedlearning.RData\"))\ntibble(\n  variable=names(tel),\n  description=c(\"Unique Participant Identifier\", \"Group denoting whether the participant studied the material twice (StudyStudy), or studied it once then did a test (StudyTest)\",\"Time of recall test ('min' = Immediate, 'week' = One week later)\",\"Word being recalled (175 different test words)\",\"Whether or not the word was correctly recalled\",\"Time to recall word (milliseconds)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### msmr_trolley.csv - trolley problems<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#binomial-outcome</span>\n\nThe \"Trolley Problem\" is a thought experiment in moral philosophy that asks you to decide whether or not to pull a lever to divert a trolley. Pulling the lever changes the trolley direction from hitting 5 people to a track on which it will hit one person.  \n\n```{r}\n#| echo: false\nknitr::include_graphics(\"images/trolley.png\")\n```\n\nPrevious research has found that the \"framing\" of the problem will influence the decisions people make: \n\n```{r}\n#| echo: false\ntribble(\n  ~`positive frame`,~`neutral frame`,~`negative frame`,\n  \"5 people will be saved if you pull the lever; one person on another track will be saved if you do not pull the lever. All your actions are legal and understandable. Will you pull the lever?\",\"5 people will be saved if you pull the lever, but another person will die. One people will be saved if you do not pull the lever, but 5 people will die. All your actions are legal and understandable. Will you pull the lever?\",\n  \"One person will die if you pull the lever. 5 people will die if you do not pull the lever. All your actions are legal and understandable. Will you pull the lever?\"\n) |> gt::gt()\n```\n\nWe conducted a study to investigate **whether the framing effects on moral judgements depends upon the stakes (i.e. the number of lives saved)**.  \n\n120 participants were recruited, and each gave answers to 12 versions of the thought experiment. For each participant, four versions followed each of the positive/neutral/negative framings described above, and for each framing, 2 would save 5 people and 2 would save 15 people.  \n\nData are available at [https://uoepsy.github.io/data/msmr_trolley.csv](https://uoepsy.github.io/data/msmr_trolley.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/msmr_trolley.csv\")),\n  description = c(\n    \"Participant ID\",\n    \"framing of the thought experiment (positive/neutral/negative\",\n    \"lives at stake in the thought experiment (5 or 15)\",\n    \"Whether or not the participant chose to pull the lever (1 = yes, 0 = no)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### monkey social status and problem solving ability<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#binomial-outcome</span>\n\nOur primate researchers have been busy collecting more data. They have given a sample of Rhesus Macaques various problems to solve in order to receive treats. Troops of Macaques have a complex social structure, but adult monkeys tend can be loosely categorised as having either a \"dominant\" or \"subordinate\" status. The monkeys in our sample are either adolescent monkeys, subordinate adults, or dominant adults. Each monkey attempted various problems before they got bored/distracted/full of treats. Each problems were classed as either \"easy\" or \"difficult\", and the researchers recorded whether or not the monkey solved each problem. \n\nWe're interested in **how the social status of monkeys is associated with the ability to solve problems**.  \n\nData are available at [https://uoepsy.github.io/data/msmr_monkeystatus.csv](https://uoepsy.github.io/data/msmr_monkeystatus.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(variable=\n         names(read_csv(\"https://uoepsy.github.io/data/msmr_monkeystatus.csv\")),\n       description = c(\n         \"Social Status of monkey (adolescent, subordinate adult, or dominant adult)\",\n         \"Problem difficulty ('easy' vs 'difficult')\",\n         \"Monkey Name\",\n         \"Whether or not the problem was successfully solved by the monkey\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/msmr_monkeystatus.csv\")\n\n# relevel difficulty\ndf$difficulty <- factor(df$difficulty, \n                        levels=c(\"easy\",\"difficult\"))\n\nmod1 <- glmer(solved ~ difficulty + status +\n                (1 + difficulty | monkeyID), \n              family=binomial,\n              data = df)\n\nsummary(mod1)\n```\n`r solend()`","srcMarkdownNoYaml":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(xaringanExtra)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggdist)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\nlibrary(lme4)\n```\n\n:::lo\n\nBelow are various datasets from these readings and from lectures and exercises across our courses. For each one, there is a quick explanation of the study design which also details the research aims of the project.  \n  \nPick one of the datasets to test yourself with fitting, checking, interpreting, and reporting on multilevel models. \n\n:::\n\n::: {.callout-note collapse=\"true\"}\n#### schoolmot.csv - motivation and grades in school children <br><span class=\"tag\">\\#cross-sectional</span>\n\nThis dataset contains information on 900 children from 30 different schools across Scotland. The data was collected as part of a study looking at **whether education-related motivation is associated with school grades. This is expected to be different for state vs privately funded schools.**   \nAll children completed an 'education motivation' questionnaire, and their end-of-year grade average has been recorded.    \n\nData are available at [https://uoepsy.github.io/data/schoolmot.csv](https://uoepsy.github.io/data/schoolmot.csv).  \n\n```{r}\n#| echo: false\ntibble(variable=names(read_csv(\"https://uoepsy.github.io/data/schoolmot.csv\")),\n       description = c(\n         \"Child's Education Motivation Score (range 0 - 10)\",\n         \"Funding ('state' or 'private')\",\n         \"Name of School that the child attends\",\n         \"Child's end-of-year grade average (0-100)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/schoolmot.csv\")\n\nmod1 <- lmer(grade ~ motiv * funding + \n               (1 + motiv | schoolid), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_lifesatscot.csv - <br><span class=\"tag\">\\#cross-sectional</span>\n\nThese data come from 112 people across 12 different Scottish dwellings (cities and towns). Information is captured on their ages and a measure of life satisfaction. The researchers are interested in if there is an association between age and life-satisfaction. \n\nData are available at [https://uoepsy.github.io/data/lmm_lifesatscot.csv](https://uoepsy.github.io/data/lmm_lifesatscot.csv){target=\"_blank\"}.\n\n```{r}\n#| echo: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_lifesatscot.csv\")\ntibble(\n  variable = names(df),\n  description = c(\"Age (years)\",\"Life Satisfaction score\",\"Dwelling (town/city in Scotland)\",\"Size of Dwelling (> or <100k people)\")\n) |> gt::gt()\n```\n\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_lifesatscot.csv\")\n\nmod <- lmer(lifesat ~ 1 + age + (1 + age | dwelling), df)\n\n# if you want to see a cross-level interaction (not relevant for RQ):\ndf$age <- df$age/10 # makes fitting easier\nmod2 <- lmer(lifesat ~ 1 + age * size + (1 + age | dwelling), df)\n```\n\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_jsup.csv - Workplace pride<br><span class=\"tag\">\\#cross-sectional</span>\n\nA questionnaire was sent to all UK civil service departments, and the lmm_jsup.csv dataset contains all responses that were received. Some of these departments work as hybrid or 'virtual' departments, with a mix of remote and office-based employees. Others are fully office-based. \n\nThe questionnaire included items asking about how much the respondent believe in the department and how it engages with the community, what it produces, how it operates and how treats its people. A composite measure of 'workplace-pride' was constructed for each employee. Employees in the civil service are categorised into 3 different roles: A, B and C. The roles tend to increase in responsibility, with role C being more managerial, and role A having less responsibility. We also have data on the length of time each employee has been in the department (sometimes new employees come straight in at role C, but many of them start in role A and work up over time). \n\nWe're interested in whether the different roles are associated with differences in workplace-pride.  \n\nData are available at [https://uoepsy.github.io/data/lmm_jsup.csv](https://uoepsy.github.io/data/lmm_jsup.csv){target=\"_blank\"}.\n\n\n```{r}\n#| echo: false\njsup <- read_csv(\"https://uoepsy.github.io/data/lmm_jsup.csv\")\ntibble(\n  variable = names(jsup),\n  description = c(\n    \"Name of government department\",\n    \"Department Acronym\",\n    \"Whether the department functions as hybrid department with various employees working remotely (1), or as a fully in-person office (0)\",\n    \"Employee role (A, B or C)\",\n    \"Employees seniority point. These map to roles, such that role A is 0-4, role B is 5-9, role C is 10-14. Higher numbers indicate more seniority\",\n    \"Length of employment in the department (years)\",\n    \"Composite Measure of 'Workplace Pride'\")\n) |> gt::gt()\n```\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_jsup.csv\")\n\n# either Roles or Seniority would work here:\nmod <- lmer(wp ~ employment_length + seniority + (1 + seniority | dept), df)\n\n# doesn't converge:\nmod <- lmer(wp ~ employment_length + role + (1 + role | dept), df)\nmod <- lmer(wp ~ employment_length + role + (1 | dept), df)\n```\n`r solend()`\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### wellbeingwork3.rda - work patterns and mental wellbeing <br><span class=\"tag\">\\#longitudinal</span>\n\nThe \"Wellbeing in Work\" dataset contains information on employee wellbeing, assessed at baseline (start of study), 12 months post, 24 months post, and 36 months post.  over the course of 36 months. \nParticipants were randomly assigned to one of three employment conditions:\n\n- control: No change to employment. Employees continue at 5 days a week, with standard allocated annual leave quota.    \n- unlimited_leave : Employees were given no limit to their annual leave, but were still expected to meet required targets as specified in their job description. \n- fourday_week: Employees worked a 4 day week for no decrease in pay, and were still expected to meet required targets as specified in their job description.\n\nThe researchers have two main questions: **Overall, did the participants' wellbeing stay the same or did it change? Did the employment condition groups differ in the how wellbeing changed over the assessment period?**     \n\nData are available (in **.rda** format) at [https://uoepsy.github.io/data/wellbeingwork3.rda](https://uoepsy.github.io/data/wellbeingwork3.rda)\n\n```{r}\n#| echo: false\nload(url(\"https://uoepsy.github.io/data/wellbeingwork3.rda\"))\nd3 <- wellbeingwork3\ntibble(variable=names(d3),\n       description = c(\n         \"Participant ID\",\n         \"Timepoint (0 = baseline, 1 = 12 months, 2 = 24 months, 3 = 36 months)\",\n         \"Employment Condition ('control' = 5 day week, 28 days of leave. 'unlimited_leave' = 5 days a week, unlimited leave. 'fourday_week' = 4 day week, 28 days of leave)\",\n         \"Wellbeing score (Warwick Edinburgh Mental Wellbeing Scale). Range 15 - 75, with higher scores indicating better mental wellbeing\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\nload(url(\"https://uoepsy.github.io/data/wellbeingwork3.rda\"))\n\nmod1 <- lmer(Wellbeing~TimePoint+(1+TimePoint|ID), \n             data = wellbeingwork3)\nmod2 <- lmer(Wellbeing~TimePoint+Condition+(1+TimePoint|ID), \n             data = wellbeingwork3)\nmod3 <- lmer(Wellbeing~TimePoint*Condition+(1+TimePoint|ID), \n             data = wellbeingwork3)\nanova(mod1,mod2,mod3)\n\nsummary(mod3)\n```\n`r solend()`\n\n\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### toy2.csv - Toys!<br><span class=\"tag\">\\#cross-sectional</span>\n\nThis example builds on one from the USMR course, where the lectures explored linear regression with a \"toy dataset\" looking at how **hours of practice influences the reading age** of different toy characters (see [USMR Week 7 Lecture](https://uoepsy.github.io/usmr/2324/lectures/lecture06.html#/learning-to-read-1){target=\"_blank\"}). Here, we broaden our scope to the investigation of how practice affects reading age for **all** toys (not just Martin's Playmobil characters).  \n\nData are available at [https://uoepsy.github.io/data/toy2.csv](https://uoepsy.github.io/data/toy2.csv){target=\"_blank\"} containing information on 129 different toy characters that come from a selection of different families/types of toy.   \n\n```{r echo=FALSE, message=FALSE,warning=FALSE}\nlibrary(gt)\ntibble(variable=names(read_csv(\"https://uoepsy.github.io/data/toy2.csv\")),\n       description=c(\"Type of Toy\",\"Year Released\",\"Character\",\"Hours of practice per week\",\"Reading Age\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/toy2.csv\")\n\nmod <- lmer(R_AGE ~ 1 + hrs_week + (1 + hrs_week | toy_type), df)\n```\n`r solend()`\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### LAAwellbeing.csv - mental wellbeing across Scotland<br><span class=\"tag\">\\#cross-sectional</span>\n\nResearchers want to study the **relationship between time spent outdoors and mental wellbeing**, across all of Scotland. They contact all the Local Authority Areas (LAAs) and ask them to collect data for them, with participants completing the Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), a self-report measure of mental health and well-being, and being asked to estimate the average number of hours they spend outdoors each week. Twenty of the Local Authority Areas provided data. \n\nData are available at [https://uoepsy.github.io/data/LAAwellbeing.csv](https://uoepsy.github.io/data/LAAwellbeing.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/LAAwellbeing.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"Participant Identifier\",\n                \"Participant Name\",\n                \"Local Authority Area\",\n                \"Number of hours spent outdoors per week\",\n                \"Wellbeing score (Warwick Edinburgh Mental Wellbeing Scale). Range 15 - 75, with higher scores indicating better mental wellbeing\",\n                \"Population density of local authority area (number of people per square km)\")\n) |> gt::gt()\n\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/LAAwellbeing.csv\")\n\nmod1 <- lmer(wellbeing ~ density + outdoor_time + \n       (1 + outdoor_time | laa), \n       data = df) \n\nsummary(mod1)\n```\n\neaster egg: check for influential people! \n\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### stressint.csv - CBT and stress levels<br><span class=\"tag\">\\#longitudinal</span>\n\nThese data are simulated to represent data from 50 participants, each measured at 3 different time-points (pre, during, and post) on a measure of stress. Participants were randomly allocated such that half received some cognitive behavioural therapy (CBT) treatment, and half did not. This study is interested in assessing **whether the two groups (control vs treatment) differ in changes in stress across the 3 time points**. \n\nThe data are available at [https://uoepsy.github.io/data/stressint.csv](https://uoepsy.github.io/data/stressint.csv).  \n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/stressint.csv\")),\n  description = c(\"Participant Identifier\",\"Stress (range 0 to 100)\",\"Time (pre/post/during)\",\n                  \"Whether participant is in the CBT group or control group\")\n) |> gt::gt()\n```\n\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressint.csv\")\ndf$time <- factor(df$time, levels=c(\"Pre\",\"During\",\"Post\"))\n```\n\nTemptation is to fit the below, but it won't work, because each pid has only 1 obs for each time-point, so we're overfitting (the whole *Error: number of observations (=150) <= number of random effects (=150) for term* message).  \n```{r}\n#| eval: false\n#| error: true\n#| warning: true\n#| message: true\nmod1 <- lmer(stress ~ time*group + \n               (1 + time|ppt), \n             data = df)\n```\n\n```{r}\n#| eval: false\nmod1 <- lmer(stress ~ time*group + \n               (1 |ppt), \n             data = df)\n\nsummary(mod1)\n```\n\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### drivingmusicwithin.csv - the influence of music on driving speeds<br><span class=\"tag\">\\#repeated-measures</span>\n\nThese data are simulated to represent data from a fake experiment, in which participants were asked to drive around a route in a 30mph zone. Each participant completed the route 3 times (i.e. \"repeated measures\"), but each time they were listening to different audio (either speech, classical music or rap music). Their average speed across the route was recorded. \nThis is a fairly simple design, that we might use to ask **\"how is the type of audio being listened to associated with driving speeds?\"** \n\nThe data are available at [https://uoepsy.github.io/data/drivingmusicwithin.csv](https://uoepsy.github.io/data/drivingmusicwithin.csv).  \n\n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/drivingmusicwithin.csv\")),\n  description = c(\"Participant Identifier\",\"Avg Speed Driven on Route (mph)\",\"Music listened to while driving (classical music / rap music / spoken word)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/drivingmusicwithin.csv\")\n```\n\nTemptation is to fit the below, but it won't work, because each pid has only 1 obs for each music, so we're overfitting\n```{r}\n#| eval: false\n#| error: true\n#| warning: true\n#| message: true\nmod1 <- lmer(speed ~ music + \n               (1 + music | pid), \n             data = df)\n```\n\n```{r}\n#| eval: false\nmod1 <- lmer(speed ~ music + \n               (1 | pid), \n             data = df)\n\nsummary(mod1)\n```\n\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### dapr3_mannequin.csv - the role of mannequins in clothing purchases<br><span class=\"tag\">\\#repeated-measures</span>\n\n**Does clothing seem more attractive to shoppers when it is viewed on a model, and is this dependent on item price?** 30 participants were presented with a set of pictures of items of clothing, and rated each item how likely they were to buy it. Each participant saw 20 items, ranging in price from £5 to £100. 15 participants saw these items worn by a model, while the other 15 saw the items against a white background.  \n\nData are available at [https://uoepsy.github.io/data/dapr3_mannequin.csv](https://uoepsy.github.io/data/dapr3_mannequin.csv)\n\n```{r}\n#| eval: false\n#| echo: false\nset.seed(15)\nN = 600\nn_groups = 30\ng = rep(1:n_groups, e = N/n_groups)      # the group identifier\nx = rep(seq(5,100,len=20),n_groups)\nb = rep(0:1,e=15)[g]\nre0 = rnorm(n_groups, sd = 1)  # random intercepts\nre  = re0[g]\nrex = rnorm(n_groups, sd = .4)  # random effects\nre_x  = rex[g]\nlp = (0 + re) + (1 + re_x)*scale(x) + (.5 * b) + (.5*scale(x)*b)\ny = rnorm(N, mean = lp, sd = 2) # create a continuous target variable\ndf = data.frame(x, g=factor(g), b=b, y)\n\nclothesdf <- df |> transmute(\n  purch_rating = round(56.4+scale(y)[,1]*16.2),\n  price = round(x),\n  ppt = factor(paste0(\"ppt_\",g)),\n  condition = ifelse(b==0,\"item_only\",\"model\")\n)\n# write_csv(clothesdf, \"../../data/dapr3_mannequin.csv\")\n```\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/dapr3_mannequin.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"Purchase Rating (sliding scale 0 to 100, with higher ratings indicating greater perceived likelihood of purchase)\",\n                \"Price presented with item (range £5 to £100)\",\n                \"Participant Identifier\",\n                \"Whether items are seen on a model or on a white background\")\n) |> gt::gt()\n\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\ndf <- read_csv(\"https://uoepsy.github.io/data/dapr3_mannequin.csv\")\n\n#scale price to help convergence\n#change 1 in price is now change of £10\ndf$price <- df$price/10\n\nmod1 <- lmer(purch_rating ~ price*condition + \n       (1+price|ppt), \n       data = df)\n  \nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### crqeds.csv - routine and emotion dysregulation in children<br><span class=\"tag\">\\#cross-sectional</span>\n\n**Are children with more day-to-day routine better at regulating their emotions?** A study of 200 children from 20 schools (9 private schools and 11 state schools) completed a survey containing the Emotion Dysregulation Scale (EDS) and the Child Routines Questionnaire (CRQ). \n\nData are available at [https://uoepsy.github.io/data/crqeds.csv](https://uoepsy.github.io/data/crqeds.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/crqeds.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"School Identifier\",\n                \"Emotion Dysregulation Score (range 1-6, higher values indicate more *dys*regulation of emotions)\",\n                \"Childhood Routine Questionnaire Score (range 0-7, higher values indicate more day-to-day routine)\",\n                \"School type (private / state)\")\n) |> gt::gt()\n\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/crqeds.csv\")\n\nmod1 <- lmer(EDS ~ schooltype + CRQ + \n       (1 + CRQ | schoolid), \n       data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_ef_sdmt.csv - Audio interference in executive functioning<br><span class=\"tag\">\\#repeated-measures</span>\n\nThis data is from a simulated study that aims to investigate the following research question: \n\n**How do different types of audio interfere with executive functioning, and does this interference differ depending upon whether or not noise-cancelling headphones are used?** \n\n30 healthy volunteers each completed the Symbol Digit Modalities Test (SDMT) - a commonly used test to assess processing speed and motor speed - a total of 15 times. During the tests, participants listened to either no audio (5 tests), white noise (5 tests) or classical music (5 tests). Half the participants listened via active-noise-cancelling headphones, and the other half listened via speakers in the room. Unfortunately, lots of the tests were not administered correctly, and so not every participant has the full 15 trials worth of data.  \n\nData are available at [https://uoepsy.github.io/data/lmm_ef_sdmt.csv](https://uoepsy.github.io/data/lmm_ef_sdmt.csv).  \n\n```{r}\n#| echo: false\nefrep <- read_csv(\"https://uoepsy.github.io/data/lmm_ef_sdmt.csv\")\ntibble(variable=names(efrep),\n       description = c(\n         \"Participant ID\",\n         \"Audio heard during the test ('no_audio', 'white_noise','music')\",\n         \"Whether the participant listened via speakers (S) in the room or via noise cancelling headphones (H)\",\n         \"Symbol Digit Modalities Test (SDMT) score\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_ef_sdmt.csv\")\n\nmod1 <- lmer(SDMT ~ audio * headphones + \n               (1 + audio | PID), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_nssjobsat.csv - <br><span class=\"tag\">\\#cross-sectional</span>\n\n```{r}\n#| echo: false\ndf<-read_csv(\"https://uoepsy.github.io/data/msmr_nssjobsat.csv\")\n```\n\nLet's suppose we are studying employee job satisfaction at the university, and we want to estimate the association between pay-scale and job satisfaction, controlling for the NSS rating of departments.   \nWe have `r nrow(df)` employees from `r n_distinct(df$dept)` different departments, and we got them to fill in a job satisfaction questionnaire, and got information on what their payscale was. We have also taken information from the national student survey on the level of student satisfaction for each department.  \n\nEach datapoint here represents an individual employee, and these employees are grouped into departments.  \n\nData are available at [https://uoepsy.github.io/data/msmr_nssjobsat.csv](https://uoepsy.github.io/data/msmr_nssjobsat.csv).  \n\n```{r}\n#| echo: false\ndf<-read_csv(\"https://uoepsy.github.io/data/msmr_nssjobsat.csv\")\ntibble(variable=names(df),\n       description = c(\n         \"National Student Satisfaction Rating for the Department\",\n         \"Department name\",\n         \"Pay scale of employee\",\n         \"Job satisfaction of employee\",\n         \"Binary question of whether the employee considered themselves to be satisfied with their work (1) or not (0)\"\n       )\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf<-read_csv(\"https://uoepsy.github.io/data/msmr_nssjobsat.csv\")\n\nmod <- lmer(jobsat ~ 1 + NSSrating + payscale + (1 + payscale | dept), df)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_apespecies.csv & lmm_apeage.csv - dominance in adolescence of great apes<br><span class=\"tag\">\\#longitudinal</span>\n\nWe have data from a large sample of great apes who have been studied between the ages of 1 to 10 years old (i.e. during adolescence). Our data includes 4 species of great apes: Chimpanzees, Bonobos, Gorillas and Orangutans. Each ape has been assessed on a primate dominance scale at various ages. Data collection was not very rigorous, so apes do not have consistent assessment schedules (i.e., one may have been assessed at ages 1, 3 and 6, whereas another at ages 2 and 8).  \n\nThe researchers are interested in examining **how the adolescent development of dominance in great apes differs between species.**  \n\nData on the dominance scores of the apes are available at [https://uoepsy.github.io/data/lmm_apeage.csv](https://uoepsy.github.io/data/lmm_apeage.csv){target=\"_blank\"} and the information about which species each ape is are in [https://uoepsy.github.io/data/lmm_apespecies.csv](https://uoepsy.github.io/data/lmm_apespecies.csv){target=\"_blank\"}.  \n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n```{r}\n#| echo: false\n#| label: tbl-spec1\n#| tbl-cap: \"Data Dictionary: lmm_apespecies.csv\"  \nape_species <- read_csv(\"../../data/lmm_apespecies.csv\")\ntibble(\n  variable = names(ape_species),\n  description = c(\"Ape Name\",\"Species (Bonobo, Chimpanzee, Gorilla, Orangutan)\")\n) |> gt::gt()\n```\n:::\n::: {.column width=\"10%\"}\n\n:::\n::: {.column width=\"45%\"}\n```{r}\n#| echo: false\n#| label: tbl-spec2\n#| tbl-cap: \"Data Dictionary: lmm_apeage.csv\"  \nape_age <- read_csv(\"../../data/lmm_apeage.csv\")\ntibble(\n  variable = names(ape_age),\n  description = c(\"Ape Name\",\"Age at assessment (years)\",\"Dominance (Z-scored)\")\n) |> gt::gt()\n```\n\n:::\n::::\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndfape1 <- read_csv(\"https://uoepsy.github.io/data/lmm_apespecies.csv\")\ndfape2 <- read_csv(\"https://uoepsy.github.io/data/lmm_apeage.csv\")\n\ndf <- full_join(dfape1, dfape2)\n```\n\nsome cleaning is needed:\n```{r}\n#| eval: false\ndf <- df |> \n  mutate(\n    # fix species typos\n    species = case_when(\n      species %in% c(\"chimp\",\"chimpanzee\") ~ \"chimp\",\n      species %in% c(\"gorilla\",\"gorrila\") ~ \"gorilla\",\n      TRUE ~ species\n    )\n  ) |>\n    filter(\n      # get rid of ages -99\n      age > 0, \n      # keep when dominance is between -5 and 5 \n      # (5 here is a slightly arbitrary choice, but you can see from\n      # our checks that this will only exclude the two extreme datapoints\n      # that are 21.2 and 19.4\n      (dominance < 5 & dominance > -5) \n    )\n```\n\nmodel comparison answers \"do species differ in growth of dominance?\"  \nfor \"*how* do *specific* species differ?\" we look at fixed effects.  \n```{r}\n#| eval: false\nmod <- lmer(dominance ~ age * species + (1 + age | ape), df)\nmod.rstr <- lmer(dominance ~ age + species + (1 + age | ape), df)\n\nanova(mod.rstr, mod)\n```\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_mindfuldecline.csv - mindfulness and cognitive decline<br><span class=\"tag\">\\#longitudinal</span>\n\nA study is interested in examining **whether engaging in mindfulness can prevent cognitive decline in older adults**. They recruit a sample of 20 participants at age 60, and administer the Addenbrooke's Cognitive Examination (ACE) every 2 years (until participants were aged 78). Half of the participants complete weekly mindfulness sessions, while the remaining participants did not.   \n\n  \nData are available at [https://uoepsy.github.io/data/lmm_mindfuldecline.csv](https://uoepsy.github.io/data/lmm_mindfuldecline.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\nmmd <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldecline.csv\")\ntibble(\n  variable=names(mmd),\n  description=c(\n    \"Site Identifier\",\n    \"Participant Identifier\",\n                \"Whether the participant engages in mindfulness or not (control/mindfulness)\",\n                \"Study Visit Number (1 - 10)\",\n                \"Age (in years) at study visit\",\n                \"Addenbrooke's Cognitive Examination Score. Scores can range from 0 to 100\",\n                \"Clinical diagnosis of cognitive impairment ('imp' = impaired, 'unimp' = unimpaired)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldecline.csv\")\n```\n\nif we don't recenter age, then the intercept variability `(1|ppt)` is estimated way back 60 years before we collected any data. The slopes will basically perfectly predicted these intercept differences, so the model will be singular.  \nre-centering will help.  \n```{r}\n#| eval: false\n#recenter age\ndf$ageC <- df$age-60\n\nmod1 <- lmer(ACE ~ 1 + ageC * condition + \n               (1 + ageC | ppt), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_mindfuldeclineFULL.csv - Multi-center Mindful Cognitive Aging<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nA large study involving 14 different research centers is interested in examining **whether engaging in mindfulness can prevent cognitive decline in older adults**. Each site recruits between 15 and 30 participants at age 60, and administer the Addenbrooke's Cognitive Examination (ACE) every 2 years (until participants were aged 78). For each center, roughly half of the participants engaged with daily mindfulness sessions, while the remaining participants did not.     \n\nData are available at [https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv](https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\"Site Identifier\",\n                \"Participant Identifier\",\n                \"Whether the participant engages in mindfulness or not (control/mindfulness)\",\n                \"Visit number (1 - 10)\",\n                \"Age (years) at visit\",\n                \"Addenbrooke's Cognitive Examination Score. Scores can range from 0 to 100\",\n                \"Clinical diagnosis of cognitive impairment ('imp' = impaired, 'unimp' = unimpaired)\")\n) |> gt::gt()\n\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nas above but it's nested\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_mindfuldeclineFULL.csv\")\ndf$ageC <- df$age-60\n\n# maximal model won't converge\nmmod <- lmer(ACE ~ 1 + ageC * condition + \n              ( 1 + ageC * condition | sitename) +\n               (1 + ageC | sitename:ppt), \n             data = df)\n\n# probably simplify to \nmod <- lmer(ACE ~ 1 + ageC * condition + \n              ( 1 + ageC | sitename) +\n               (1 + ageC | sitename:ppt), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### stressweek1.csv - CBD drinks and stress levels: Version 1<br><span class=\"tag\">\\#longitudinal</span>\n\nSuppose that we conducted an experiment on a sample of 20 staff members from the Psychology department to investigate **effects of CBD consumption on stress over the course of the working week**. Participants were randomly allocated to one of two conditions: the control group continued as normal, and the CBD group were given one CBD drink every day. Over the course of the working week (5 days) participants stress levels were measured using a self-report questionnaire.  \n\nData are available at [https://uoepsy.github.io/data/stressweek1.csv](https://uoepsy.github.io/data/stressweek1.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\npsychstress <- read_csv(\"https://uoepsy.github.io/data/stressweek1.csv\")\ntibble(\n  variable=names(psychstress),\n  description=c(\"Department\",\n                \"Participant Name\",\n                \"Whether or not they were allocated to the control group (N) or the CBD group (Y)\",\n                \"Measure used to assess stress levels\",\n                \"Day of the working week (1 to 5)\",\n                \"Stress Level (standardised)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressweek1.csv\")\n# re-center 'day' so the intercept is day 1\ndf$day <- df$day-1 \n\nmod1 <- lmer(stress ~ 1 + day * CBD + \n               (1 + day | pid), \n             data = df)\n\nsummary(mod1)\n```\n\n`r solend()`\n\n::: {.callout-note collapse=\"true\"}\n#### stressweek_nested.csv - CBD drinks and stress levels: Version 2<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nAs for Version 1 of this study (see above), but instead of a sample of 20 participants from the psychology staff, we have 240 people from various departments such as History, Philosophy, Art, etc.. \n\nData are available at [https://uoepsy.github.io/data/stressweek_nested.csv](https://uoepsy.github.io/data/stressweek_nested.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(\n  variable=names(read_csv(\"https://uoepsy.github.io/data/stressweek_nested.csv\")),\n  description=c(\"Department\",\n                \"Participant Name\",\n                \"Whether or not they were allocated to the control group (N) or the CBD group (Y)\",\n                \"Measure used to assess stress levels\",\n                \"Day of the working week (1 to 5)\",\n                \"Stress Level (standardised)\")\n) |> gt::gt()\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressweek_nested.csv\")\n\n# re-center 'day' so the intercept is day 1\ndf$day <- df$day-1 \n\n# removed day*CBD|dept to obtain convergence\nmod1 <- lmer(stress ~ 1 + day * CBD + \n               (1 + day + CBD | dept) +\n               (1 + day | dept:pid), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n::: {.callout-note collapse=\"true\"}\n#### stressweek_crossed.csv - CBD drinks and stress levels: Version 3<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nAs for Version 1 of this study (see above), with 20 staff members from the Psychology department, but instead of taking a measurement _only_ on a self-report scale, we took 10 different measures every time point (cortisol levels, blood pressure, heart rate variability, various questionnaires etc).  \n\nData are available at [https://uoepsy.github.io/data/stressweek_crossed.csv](https://uoepsy.github.io/data/stressweek_crossed.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\ntibble(\n  variable=names(read_csv(\"https://uoepsy.github.io/data/stressweek_crossed.csv\")),\n  description=c(\"Department\",\n                \"Participant Name\",\n                \"Whether or not they were allocated to the control group (N) or the CBD group (Y)\",\n                \"Measure used to assess stress levels\",\n                \"Day of the working week (1 to 5)\",\n                \"Stress Level (standardised)\")\n) |> gt::gt()\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/stressweek_crossed.csv\")\n\n# re-center 'day' so the intercept is day 1\ndf$day <- df$day-1 \n\n# removed day*CBD|dept to obtain convergence\nmod1 <- lmer(stress ~ 1 + day * CBD + \n                (1 + day + CBD | measure) +\n                (1 + day | pid), \n             data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### cogdecline.csv - domain differences in cognitive aging<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nThese data are simulated to represent a large scale international study of cognitive aging, for which data from 17 research centers has been combined. The study team are interested in **whether different cognitive domains have different trajectories as people age**. Do all cognitive domains decline at the same rate? Do some decline more steeply, and some less? The literature suggests that scores on cognitive ability are predicted by educational attainment, so they would like to control for this.  \n\nEach of the 17 research centers recruited a minimum of 14 participants (Median = 21, Range 14-29) at age 48, and recorded their level of education (in years). Participants were then tested on 5 cognitive domains: processing speed, spatial visualisation, memory, reasoning, and vocabulary. Participants were contacted for follow-up on a further 9 occasions (resulting in 10 datapoints for each participant), and at every follow-up they were tested on the same 5 cognitive domains. Follow-ups were on average 3 years apart (Mean = 3, SD = 0.8). \n\nData are available at [https://uoepsy.github.io/data/cogdecline.csv](https://uoepsy.github.io/data/cogdecline.csv). \n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/cogdecline.csv\")),\n  description = c(\"Center ID\",\"Participant Identifier\",\"Educational attainment (years of education)\",\"Age at visit (years)\",\n                  \"Score on Processing Speed domain task\",\n                  \"Score on Spatial Visualisation domain task\",\n                  \"Score on Memory domain task\",\n                  \"Score on Reasoning domain task\",\n                  \"Score on Vocabulary domain task\"\n                  )\n) |> gt::gt()\n```\n\n:::\n\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nwe need to reshape this data! we don't have a single variable \"score\" here, because it's actually split across 5 columns (one for each domain). So we reshape those columns to have a variable called \"score\" and a variable indicating which domain it is a score of (we'll call it \"domain\"):  \n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/cogdecline.csv\")\n\n# reshape\ndf <- df |> pivot_longer(processing_speed:vocabulary,\n                   names_to = \"domain\",\n                   values_to = \"score\")\n\n# recenter age and educ\ndf$age <- (df$age - 48)/5\ndf$educ <- df$educ - min(df$educ)\n```\nthis won't converge:\n```{r}\n#| eval: false\nmod1 <- lmer(score ~ educ + age * domain + \n               (1 + educ + age * domain | cID) + \n               (1 + age * domain | cID:pptID),\n             data = df)\n```\nthis will - it's using the trick of putting the domain on the RHS here, to still have different slopes of score~age for each domain:  \n```{r}\n#| eval: false\nmod1 <- lmer(score ~ educ + age * domain + \n               (1 | cID) + \n               (1 + age | cID:pptID) +\n               (1 + age | cID:pptID:domain),\n             data = df,\n             control=lmerControl(optimizer=\"bobyqa\"))\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_gadeduc.csv - Psychoeducation treatment effects<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n```{r}\n#| include: false\ngeduc = read_csv(\"https://uoepsy.github.io/data/lmm_gadeduc.csv\")\ngeduc1 = geduc |> \n  pivot_longer(2:last_col(), names_to=\"visit\",values_to=\"GAD\") |>\n  mutate(\n    visit = as.numeric(gsub(\"visit_\",\"\",visit))\n  ) |>\n  separate(patient, into=c(\"therapist\",\"group\",\"patient\"), sep=\"_\")\n# m = lmer(GAD~visit*group+(1+visit*group|therapist)+(1+visit|therapist:patient),geduc1)\n# summary(m)\ntn = geduc1 |> group_by(therapist) |> summarise(np = n_distinct(patient))\n```\n\nThis is synthetic data from a randomised controlled trial to **evaluate the efficacy of a psychoeducational treatment on anxiety disorders**, in which `r nrow(tn)` therapists randomly assigned patients (each therapist saw between `r min(tn[,'np'])` and `r max(tn[,'np'])` patients) to a control or treatment group, and monitored their scores over time on a measure of generalised anxiety disorder (GAD7 - a 7 item questionnaire with 5 point likert scales).  \n\nThe control group of patients received standard sessions offered by the therapists. \nFor the treatment group, 10 mins of each sessions was replaced with a specific psychoeducational component, and patients were given relevant tasks to complete between each session. All patients had monthly therapy sessions. Generalised Anxiety Disorder was assessed at baseline and then every visit over 4 months of sessions (5 assessments in total).  \n\nData are available at [https://uoepsy.github.io/data/lmm_gadeduc.csv](https://uoepsy.github.io/data/lmm_gadeduc.csv){target=\"_blank\"}\n\nYou can find a data dictionary below:\n```{r}\n#| echo: false\ntibble(\n    variable = names(geduc),\n    description = c(\"A patient code in which the labels take the form <Therapist initials>_<group>_<patient number>.\",\"Score on the GAD7 at baseline\", \n                    \"GAD7 at 1 month assessment\",\n                    \"GAD7 at 2 month assessment\",\n                    \"GAD7 at 3 month assessment\",\n                    \"GAD7 at 4 month assessment\"\n                    )\n)  |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nthis one needs lots of reshaping and sorting out first, but it can actually be done with minimal code using things like `separate()`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_gadeduc.csv\")\ndf <- df |> \n  pivot_longer(2:last_col(), names_to=\"visit\",values_to=\"GAD\") |>\n  mutate(\n    visit = as.numeric(gsub(\"visit_\",\"\",visit))\n  ) |>\n  separate(patient, into=c(\"therapist\",\"group\",\"patient\"), sep=\"_\")\n\nmod <- lmer(GAD~ visit*group+ \n              (1+visit*group|therapist)+\n              (1+visit|therapist:patient),\n            df)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n### abs_intervention.csv - evaluating an intervention to reduce adolescent aggressive behaviours<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nIn 2010 A US state's commissioner for education was faced with growing community concern about rising levels of adolescent antisocial behaviours. \n\nAfter a series of focus groups, the commissioner approved the trialing of an intervention in which yearly Parent Management Training (PMT) group sessions were offered to the parents of a cohort of students entering 10 different high schools. Every year, the parents were asked to fill out an informant-based version of the Aggressive Behaviour Scale (ABS), measuring verbal and physical abuse, socially inappropriate behavior, and resisting care. Where possible, the same parents were followed up throughout the child's progression through high school. Alongside this, parents from a cohort of students entering 10 further high schools in the state were recruited to also complete the same informant-based ABS, but were not offered the PMT group sessions.  \nThe commissioner has two main questions: **Does the presentation of aggressive behaviours increase as children enter the secondary school system? Is there any evidence for the effectiveness of Parent Management Training (PMT) group sessions in curbing the rise of aggressive behaviors during a child's transition into the secondary school system?**  \n\nData are available at [https://uoepsy.github.io/data/abs_intervention.csv](https://uoepsy.github.io/data/abs_intervention.csv) \n\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/abs_intervention.csv\")\ntibble(variable=names(d3),\n       description = c(\n         \"School Name\",\n         \"Participant Identifier\",\n         \"Age (years)\",\n         \"Whether or not parents attended Parent Management Training (PMT) group sessions (0 = No, 1 = Yes)\",\n         \"Aggressive Behaviours Scale. Measures verbal and physical abuse, socially inappropriate behavior, and resisting care. Scores range from 0 to 100, with higher scores indicating more aggressive behaviours.\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nCheck here: [https://uoepsy.github.io/dapr3/2425/lectures/05recap.html#/the-research-process-model-specification ](https://uoepsy.github.io/dapr3/2425/lectures/05recap.html#/the-research-process-model-specification ){target=\"_blank\"}\n\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n### lmm_laughs.csv - the visual aspect of humour<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n```{r}\n#| include: false\nlaughs <- read_csv(\"https://uoepsy.github.io/data/lmm_laughs.csv\")\n```\n\nThese data are simulated to imitate an experiment that investigates the effect of visual non-verbal communication (i.e. gestures, facial expressions) on joke appreciation. \n`r n_distinct(laughs$ppt)` Participants took part in the experiment, in which they each rated how funny they found a set of `r n_distinct(laughs$joke_id)` jokes. For each participant, the order of these `r n_distinct(laughs$joke_id)` jokes was randomly set for each run of the experiment. For each participant, the set of jokes was randomly split into two halves, with the first half being presented in audio-only, and the second half being presented in audio and video. This meant that each participant saw `r n_distinct(laughs$joke_id)/2` jokes with video and `r n_distinct(laughs$joke_id)/2` without, and each joke would be presented in with video roughly half of the times it was seen.  \n\nThe researchers want to investigate **whether the delivery (audio/audiovideo) of jokes is associated with differences in humour-ratings.**  \n\nData are available at [https://uoepsy.github.io/data/lmm_laughs.csv](https://uoepsy.github.io/data/lmm_laughs.csv)\n\n```{r}\n#| echo: false\n#| label: tbl-laughdict\n#| tbl-cap: \"Data Dictionary: lmm_laughs.csv\"\ntibble(\n  variable = names(laughs),\n  description = c(\"Participant Identification Number\",\n                  \"Joke presented\",\n                  \"Joke Identification Number\",\n                  \"Experimental manipulation: whether joke was presented in audio-only ('audio') or in audiovideo ('video')\",\n                  \"Humour rating chosen on a slider from 0 to 100\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_laughs.csv\")\n\nmod <- lmer(rating ~ delivery + \n              (1 + delivery | joke_id) +\n              (1 + delivery | ppt),\n            data = df)\n```\n\nworth looking at random effects for different jokes to see which ones are funniest etc.  \nThe jokes are all from some study 10 years ago that aimed to find \"the worlds funniest joke\"  \n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n### NGV.csv - Video game aggression and the dark triad<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#more-complex-groupings</span>\n\nThese data are from an experiment designed to investigate **how the realism of video games is associated with more/less unnecessarily aggressive gameplay, and whether this differs depending upon a) the playing mode (playing on a screen vs VR headset), and b) individual differences in the 'dark triad' personality traits.**  \n\nThe experiment involved playing 10 levels of a game in which the objective was to escape a maze. Various obstacles and other characters were present throughout the maze, and players could interact with these by side-stepping or jumping over them, or by pushing or shooting at them. All of these actions took the same amount of effort to complete (pressing a button), and each one achieved the same end (moving beyond the obstacle and being able to continue through the maze).  \n\nEach participant completed all 10 levels twice, once in which all characters were presented as cartoons, and once in which all characters were presented as realistic humans and animals. The layout of the level was identical in both, the only difference being the depiction of objects and characters. For each participant, these 20 levels ($2 \\times 10$ mazes) were presented in a random order. Half of the participants played via a screen, and the other half played via a VR headset. For each level played, we have a record of \"needless game violence\" (NGV) which was calculated via the number of aggressive (pushing/shooting) actions taken (+0.5 for every action that missed an object, +1 for every action aimed at an inanimate object, and +2 for every action aimed at an animate character).  \nPrior to the experiment, each participant completed the Short Dark Triad 3 (SD-3), which measures the three traits of machiavellianism, narcissism, and psychopathy.  \n\nData are available at [https://uoepsy.github.io/data/NGV.csv](https://uoepsy.github.io/data/NGV.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\nngv <- read_csv(\"../../data/NGV.csv\")\ntibble(\n  variable=names(ngv),\n  description=c(\n    \"Participant number\",\n    \"Participant age (years)\",\n    \"Maze level (1 to 20)\",\n    \"Whether the objects and characters in the level were presented as 'cartoon' or as 'realistic'\",\n    \"Whether the participant played via a screen or with a VR headset\",\n    \"Psycopathy Trait from SD-3 (score 1-5)\",\n    \"Narcissism Trait from SD-3 (score 1-5)\",\n    \"Machiavellianism Trait from SD-3 (score 1-5)\",\n    \"Needless Game Violence metric\"\n  )\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n_(you could also try to fit the interactions in the random effects here but i'm not going to even try!)_  \n```{r}\n#| eval: false\nm0 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + character + mode + P + M + N | level), data = ngv)\n```\n\nafter some simplification, I end up at the model below. You might end up at a slightly different random effect structure, and that is completely okay! The important thing is to be transparent in your decisions.  \n```{r}\n#| eval: false\nm1 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + mode | level), data = ngv)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### erm_belief.csv - erm.. I don't believe you<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n\nThese data are simulated to represent data from 30 participants who took part in an experiment designed to investigate **whether fluency of speech influences how believable an utterance is perceived to be**.  \n\nEach participant listened to the same 20 statements, with 10 being presented in fluent speech, and 10 being presented with a disfluency (an \"erm, ...\"). Fluency of the statements was counterbalanced such that 15 participants heard statements 1 to 10 as fluent and 11 to 20 as disfluent, and the remaining 15 participants heard statements 1 to 10 as disfluent, and 11 to 20 as fluent. The order of the statements presented to each participant was random. Participants rated each statement on how believable it is on a scale of 0 to 100.  \n\nData are available at [https://uoepsy.github.io/data/erm_belief.csv](https://uoepsy.github.io/data/erm_belief.csv). \n\n```{r echo=FALSE}\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/erm_belief.csv\")),\n  description = c(\"Participant Identifier\",\"Trial number\", \"Statement identifier\", \"Condition (fluent v disfluent)\", \"belief rating (0-100)\", \"Statement\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\n\ndf <- read_csv(\"https://uoepsy.github.io/data/erm_belief.csv\")\n# make trial_n numeric\ndf$trial_n <- as.numeric(gsub(\"trial_\",\"\",df$trial_n))\n# relevel condition:\ndf$condition <- factor(df$condition, levels=c(\"fluent\",\"disfluent\"))\n\n# having (trial_n | ppt) doesn't converge, so simplify to:\nmod1 <- lmer(belief ~ trial_n + condition + \n               (1 | ppt) + \n               (1 + condition | statement), \n             data = df)\n\nsummary(mod1)\n```\n\neaster egg: plot your ranefs\n```{r}\n#| eval: false\ndotplot.ranef.mer(ranef(mod1))$statement\n```\n\n\n`r solend()`\n\n\n\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_alcgad.csv - relative levels of anxiety and alcohol use<br><span class=\"tag\">\\#repeated-measures</span>\n\nA research study is investigating **how anxiety is associated with drinking habits**. Data was collected from 50 participants from 5 centers. Researchers administered the generalised anxiety disorder (GAD-7) questionnaire to measure levels of anxiety over the past week, and collected information on the units of alcohol participants had consumed within the week. Each participant was observed on 10 different occasions. \n\nThe researchers are also interested in testing an intervention (given to half of the participants) - they want to know if this changes the association between anxiety and alcohol consumption.  \n\n```{r}\n#| echo: false\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/lmm_alcgad.csv\")),\n  description = c(\n    \"Number of units of alcohol consumed over the past week\",\n    \"Score on the Generalised Anxiety Disorder scale (scores 0-3 on 7 questions are totalled for an overall score)\",\n    \"Whether the participant is part of the intervention group (1) or not (0)\",\n    \"Center ID\",\n    \"Participant ID\"\n    )\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nWe actually have participants nested in center here, but there are only 5 centers.. \n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_alcgad.csv\")\n\n```\nfirst though, we'll calculate ppt means and ppt deviations-from-means\n```{r}\n#| eval: false\ndf <- df |> \n  group_by(ppt) |>\n  mutate(\n    gadm = mean(gad),\n    gaddev = gad - mean(gad)\n  ) |> ungroup()\n```\n\nthis works, but bear in mind we do only have 5 centers.. \n```{r}\n#| eval: false\nmod <- lmer(alcunits ~ gadm + gaddev + \n       (1 + gaddev | center) +\n       (1 + gaddev | center:ppt),\n     df)\n```\nthis would be defensible too:  \n```{r}\n#| eval: false\nmod <- lmer(alcunits ~ center + gadm + gaddev + \n       (1 + gaddev | ppt),\n     df)\n```\n\nWe also have the intervention question, which to meet convergence might need to do something like: \n```{r}\n#| eval: false\nmod <- lmer(alcunits ~ center + (gadm + gaddev)*intervention + \n       (1 | ppt),\n     df)\n```\n`r solend()`\n\n\n::: {.callout-note collapse=\"true\"}\n#### dapr3_tgu.csv - Physiotherapy and physical functioning <br><span class=\"tag\">\\#repeated-measures</span>\n\n```{r}\n#| eval: false\n#| echo: false\nlibrary(lme4)\nset.seed(86)\ndoit<-1\nwhile(doit){\n  Ngroup2s = 10\n  dd2<-MASS::mvrnorm(n=Ngroup2s, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n  cor(dd2)\n  i = 2\n  df<-as.data.frame(c())\n  for(i in 1:Ngroup2s){\n    Ngroups = round(rnorm(1,10,0))\n    Nxgroups = 2\n    \n    #NperGroup = rep(Nxgroups*nrep,Ngroups)\n    NperGroup = rdunif(Ngroups, 5, 10)*Nxgroups\n    N = sum(NperGroup)\n    \n    dd<-MASS::mvrnorm(n=Ngroups, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n    ddb<-MASS::mvrnorm(n=Ngroups, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n    ddx<-MASS::mvrnorm(n=Nxgroups, mu = c(0,0), Sigma = matrix(c(1,0,0,1),byrow = T, nrow=2))\n    \n    igs = map(seq_along(NperGroup), ~rep(.,NperGroup[.])) %>% unlist\n    xgs = map(1:Ngroups, ~rep(1:Nxgroups,NperGroup[.]/Nxgroups)) %>% unlist\n    #x = map(1:Ngroups, ~rep(1:NperGroup[.],Nxgroups)) %>% unlist\n    xxm = rnorm(Ngroups,50,10)\n    xxm = map(1:Ngroups, ~rep(xxm[.], NperGroup[.])) %>% unlist\n    xgc = map(1:Ngroups, ~rnorm(NperGroup[.], 0, 3)) %>% unlist\n    #xx = map(1:Ngroups, ~rep(rnorm(1,3,.6), NperGroup[.]))%>% unlist\n    xx = xxm+xgc \n    \n    l2p = sample(1:4, Ngroups, replace=T, prob = c(.2,.5,.3,.1))\n    l2p = map(1:Ngroups, ~rep(l2p[.], NperGroup[.])) %>% unlist\n    \n    l3p = i %% 2\n    e = rnorm(N, sd = 15)\n    \n    y = 0 +\n      dd[igs,1]+\n      dd2[i,1]+\n      #ddx[xgs, 1] + \n      -5*xxm+\n      #-.05*(xx2 %in% c(1,2,4))*xgc+\n      -6*xgc + \n      dd[igs,2]*xgc +\n      #ddb[igs,2]*xxm + \n      1*dd2[i,2]*xxm +\n      -3*l2p + \n      2*l3p +\n      e\n    d = data.frame(y,xxm,xgc,igs,xgs,i, l2p,l3p)\n    #ggplot(d,aes(x=x,y=y,group=factor(igs)))+facet_wrap(~xgs)+geom_path()\n    d$ng2 = i\n    df<-rbind(df,d)\n  }\n  df %>% filter(xgs == 1) %>%\n  lmer(y ~ xxm + xgc + l2p + l3p + (1+xgc | ng2/igs), data =.,\n       control=lmerControl(optimizer = \"bobyqa\")) -> m \n  print(VarCorr(m))\n  t1 = attributes(VarCorr(m)[[1]])$stddev\n  t2 = attributes(VarCorr(m)[[1]])$correlation\n  t3 = attributes(VarCorr(m)[[2]])$stddev\n  t4 = attributes(VarCorr(m)[[2]])$correlation\n  \n  if(!isSingular(m) & all(t1 != 0) & !(t2[lower.tri(t2)] %in% c(0,1,-1)) & all(t3 != 0) & !(t4[lower.tri(t4)] %in% c(0,1,-1)) ){\n    doit <- 0\n  }\n}\n\ndf %>% filter(xgs==1) %>% transmute(\n  tgu = 8+(scale(y)[,1]*4),\n  phys = round(xxm + xgc),\n  hospital = ng2,\n  patient = igs,\n  prioritylevel = l2p,\n  private = l3p\n) %>% filter(hospital%in%c(5,6)) %>% \n  mutate(hospital=paste0(\"Hospital_\",hospital),\npatient = paste0(hospital,patient))-> tgudat\n\n#write_csv(tgudat, \"../../data/dapr3_tgu.csv\")\n```\n\nA researcher is interested in the efficacy of physiotherapy in helping people to regain normal physical functioning. They are curious **whether doing more physiotherapy leads to better outcomes, or if it is possibly that the patients who tend to do more of their exercises tend to have better outcomes**. 20 in-patients from 2 different hospitals (1 private, 1 govt funded) were monitored over the course of their recovery following knee-surgery. Every day, the time each patient spent doing their physiotherapy exercises was recorded. At the end of each day, participants completed the \"Time get up and go\" task, a measure of physical functioning.  \n\nData are available at [https://uoepsy.github.io/data/dapr3_tgu.csv](https://uoepsy.github.io/data/dapr3_tgu.csv)\n\n```{r}\n#| echo: false\nd3 <- read_csv(\"https://uoepsy.github.io/data/dapr3_tgu.csv\")\ntibble(\n  variable=names(d3),\n  description=c(\n    \"Time Get up and Go Task - measure of physical functioning. Scored in minutes, with lower scores indicating better physical functioning\",\n    \"Minutes of physiotherapy exercises completed that day\",\n    \"Hospital ID\",\n    \"Patient ID\",\n    \"Priority level of patients' surgery (rank 1-4, with 1 being most urgent surgey, and 4 being least urgent)\",\n    \"0 = government funded hospital, 1 = private hospital\"\n  )\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\npatients are nested in hospitals, but there are only 2 hospitals!  \njust shove it in as fixed predictor\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/dapr3_tgu.csv\")\n\ndf <- df |> group_by(patient) |>\n  mutate(\n    physm = mean(phys),\n    physdev = phys - mean(phys)\n  ) |> ungroup()\n\nmod <- lmer(tgu ~ hospital + physm + physdev + \n              (1 + physdev | patient),\n            data = df)\n```\n`r solend()`\n\n\n::: {.callout-note collapse=\"true\"}\n#### lmm_bflpe.csv - big fish little pond <br><span class=\"tag\">\\#cross-sectional</span>\n\n```{r}\n#| echo: false\nbfdat <- read_csv(\"https://uoepsy.github.io/data/lmm_bflpe.csv\")\n```\n\n\nThese data are simulated based on the [\"Big-fish-little-pond\" effect](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6124391/){target=\"_blank\"} in educational literature. \n\nWe are interested in better understanding the relationship between school children's grades and their academic self-concept (their self-perception of ability in specific and general academic disciplines).  \n\nWe have data from `r n_distinct(bfdat$class)` classes of children, capturing information on their grades at school (range 0 to 10), and a measure of academic self-concept:  \n\nData are available at  [https://uoepsy.github.io/data/lmm_bflpe.csv](https://uoepsy.github.io/data/lmm_bflpe.csv)  \n\n```{r}\n#| echo: false\nbfdat <- read_csv(\"https://uoepsy.github.io/data/lmm_bflpe.csv\")\ntibble(\n  variable = names(bfdat),\n  description = c(\"Children's School Grade\",\n                  \"Class Identifier\",\n                  \"Children's Self-Concept Score\",\n                  \"Child Identifier\")\n) |> gt::gt()\n```\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/lmm_bflpe.csv\")\n\ndf <- df |> group_by(class) |>\n  mutate(\n    gradem = mean(grade),\n    gradedev = grade - mean(grade)\n  )\n\nmod <- lmer(self_concept ~ gradem + gradedev + \n              (1 + gradedev | class), \n            data = df)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### hangry.csv - hunger + anger = hanger<br><span class=\"tag\">\\#cross-sectional</span>\n\nThis study is interested in evaluating **whether peoples' hunger levels are associated with their levels of irritability** (i.e., \"the hangry hypothesis\"), and if this differs between people on a diet vs those who aren't. 81 participants were recruited into the study. Once a week for 5 consecutive weeks, participants were asked to complete two questionnaires, one assessing their level of hunger, and one assessing their level of irritability. The time and day at which participants were assessed was at a randomly chosen hour between 7am and 7pm each week. 46 of the participants were following a five-two diet (five days of normal eating, 2 days of fasting), and the remaining 35 were following no specific diet.  \n\nData are available at  [https://uoepsy.github.io/data/hangry.csv](https://uoepsy.github.io/data/hangry.csv)  \n\n```{r}\n#| echo: false\nhangry<-read_csv(\"https://uoepsy.github.io/data/hangry.csv\") %>% mutate(fivetwo=factor(fivetwo))\ntibble(\n    variable = names(hangry),\n    description = c(\"Score on irritability questionnaire (0:100)\",\n                    \"Score on hunger questionnaire (0:100)\",\n                    \"Participant Identifier\",\n                    \"Whether the participant follows the five-two diet\")\n) %>% gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/hangry.csv\")\n\ndf <- df |> group_by(ppt) |>\n  mutate(\n    hungerm = mean(q_hunger),\n    hungerdev = q_hunger - mean(q_hunger)\n  )\n\nmod <- lmer(q_irritability ~ (hungerm + hungerdev) * fivetwo +\n              (1 + hungerdev | ppt), \n            data = df,\n            control=lmerControl(optimizer=\"bobyqa\"))\n\n```\n`r solend()`\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### pvt_bilingual.csv - Vocabulary development in monolingual and bilingual children<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#non-linear</span><span class=\"tag\">\\#more-complex-groupings</span>\n\n```{r}\n#| echo: false\npvt <- read_csv(\"https://uoepsy.github.io/data/pvt_bilingual.csv\")\npvtsc = pvt |> count(school,child,isBilingual)\n```\n\n`r nrow(pvtsc)` children from `r length(unique(pvt$school))` schools were included in the study. Children were assessed on a yearly basis for 7 years throughout primary school on a measure of vocabulary administered in English, the Picture Vocab Test (PVT). `r sum(pvtsc$isBilingual==0)` were monolingual English speakers, and `r sum(pvtsc$isBilingual==1)` were bilingual (english + another language). \n\nPrevious research conducted on monolingual children has suggested that that scores on the PVT increase steadily up until the age of approximately 7 or 8 at which point they begin to plateau. The aim of the present study is to **investigate differences in the development of vocabulary between monolingual and bilingual children.**  \n\nData are available at [https://uoepsy.github.io/data/pvt_bilingual.csv](https://uoepsy.github.io/data/pvt_bilingual.csv).  \n\n```{r}\n#| echo: false\ntibble(variable = names(pvt),\n       description = c(\n         \"Child's name\",\n         \"School Identifier\",\n         \"Binary variable indicating whether the child is monolingual (0) or bilingual (1)\",\n         \"Age (years)\",\n         \"Score on the Picture Vocab Test (PVT). Scores range 0 to 60\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nLet's read in the data:  \n```{r}\npvt <- read_csv(\"https://uoepsy.github.io/data/pvt_bilingual.csv\")\n```\n\nWe have 30 distinct schools:\n```{r}\nn_distinct(pvt$school)\n```\n\nAnd 418 distinct children. Is that right?  \n```{r}\nn_distinct(pvt$child)\n```\n\nGiven that the `pvt$child` variable is just the first name of the child, it's entirely likely that there will be, for instance more than one \"Martin\".  \n\nThis says that there are 487!  \n```{r}\npvt |> count(school, child) |> nrow()\n```\n\nBut wait... we could _still_ have issues. What if there were 2 \"Martin\"s at the same school??\n```{r}\n\npvt |> \n  # count the school-children groups\n  count(school, child) |> \n  # arrange the output so that the highest \n  # values of the 'n' column are at the top\n  arrange(desc(n))\n```\n\nAha! There are 7 cases where schools have two children of the same name. Remember that each child was measured at 7 timepoints. We shouldn't have people with 14!  \n\nIf we actually _look_ at the data, we'll see that it is very neatly organised, with each child's data together. This means that we could feasibly make an educated guess that, e.g., the \"Jackson\" from \"School 3\" in rows 155-161 is different from the \"Jackson\" from \"School 3\" at rows 190-196. \n\nBecause of the ordering of our data, we can do something like this:  \n```{r}\npvt <- \n  pvt |>\n  # group by the school and child\n  group_by(school, child) |>\n  mutate(\n    # make a new variable which counts from 1 to \n    # the number of rows for each school-child\n    n_obs = 1:n()\n  ) |>\n  # ungroup the data\n  ungroup() |>\n  mutate(\n    # change it so that if the n_obs is >7, the \n    # child becomes \"[name] 2\", to indicate they're the second\n    # child with that name\n    child = ifelse(n_obs>7, paste0(child,\" 2\"), child)\n  )\n```\n\nNow we have 494!  \n```{r}\npvt |> count(school, child) |> nrow()\n```\n\nAnd nobody has anything other than 7 observations!\n```{r}\npvt |> count(school, child) |>\n  filter(n != 7)\n```\n\nPhew!  \n\nOkay, let's just fit an intercept-only model:  \n```{r}\npvt_null <- lmer(PVT ~ 1 +  (1 | school/child), data = pvt)\nsummary(pvt_null)\n```\n\n```{r}\n#| echo: false\nvcres = VarCorr(pvt_null) |> as.data.frame()\nvcres = round(vcres$vcov,2)\n```\n\n\nAs we can see from `summary(bnt_null)`, the random intercept variances are `r vcres[1]` for child-level, `r vcres[2]` for school-level, and the residual variance is `r vcres[3]`.\n\nSo child level differences account for $\\frac{`r vcres[1]`}{`r paste0(vcres,collapse=\" + \")`} = `r round(vcres[1]/sum(vcres),2)`$ of the variance in PVT scores, and child & school differences together account for $\\frac{`r paste0(vcres[1:2],collapse=\" + \")`}{`r paste0(vcres,collapse=\" + \")`} = `r round(sum(vcres[1:2])/sum(vcres),2)`$ of the variance.\n\nHere's an initial plot too:\n\n```{r}\nggplot(pvt, aes(x=age,y=PVT,col=factor(isBilingual)))+\n  stat_summary(geom=\"pointrange\")+\n  stat_summary(geom=\"line\")\n```\n\nI feel like either raw or orthogonal polynomials would be fine here - there's nothing explicit from the study background about stuff \"at baseline\". There's the stuff about the plateau at 7 or 8, but we can get that from the model plots. Orthogonal will allow us to compare the trajectories overall (their linear trend, the 'curviness' and 'wiggliness').  \n\nAn additional benefit of orthogonal polynomials is that we are less likely to get singular fits when we include polynomial terms in our random effects. Remember, raw polynomials are correlated, so often the by-participant variances in raw poly terms are highly correlated. \n\nI've gone for 3 degrees of polynomials here because the plot above shows a bit of an S-shape for the bilinguals. \n\n```{r}\npvt <- pvt |> mutate(\n  poly1 = poly(age, 3)[,1],\n  poly2 = poly(age, 3)[,2],\n  poly3 = poly(age, 3)[,3],\n  isBilingual = factor(isBilingual)\n)\n```\n\nThese models do not converge.  \nI've tried to preserve the by-child random effects of time, because while I think Schools probably _do_ vary, School's all teach the same curriculum, whereas there's _a lot_ of varied things that can influence a child's vocabulary, both in and out of school  \n```{r}\n#| eval: false\nmod1 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + (poly1 + poly2 + poly3)*isBilingual | school) + \n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod2 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual * (poly1 + poly2) + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod3 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual * poly1 + poly2 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod4 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual + poly1 + poly2 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nmod5 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + isBilingual + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n# relative to the variance in time slopes, there's v little by-school variance in bilingual differences in vocab\n\nmod6 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly2 +  poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n# looks like curvature doesn't vary between schools much as linear and wiggliness \n```\n\nthis one does! \n```{r}\nmod7 <- lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n```\n\n\n```{r}\nlibrary(broom.mixed)\naugment(mod7) |> \n  mutate(\n    poly1 = round(poly1, 3) # because of rounding errors that make plot weird\n  ) |>\n  ggplot(aes(x=poly1,col=isBilingual))+\n  stat_summary(geom=\"pointrange\",aes(y=PVT))+\n  stat_summary(geom=\"line\", aes(y=.fitted))\n```\n\nrefitted with lmerTest:  \n```{r}\nmod7 <- lmerTest::lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\nsummary(mod7)\n```\n\n```{r}\n#| echo: false\nmm <- lmerTest::lmer(PVT ~ 1 + (poly1 + poly2 + poly3) * isBilingual + \n       (1 + poly1 + poly3 | school) +\n       (1 + (poly1 + poly2 + poly3) | school:child),\n     data = pvt)\n\ntidy(mm) |> filter(effect==\"fixed\") |> transmute(\n  term,\n  est = round(estimate,2),\n  p = ifelse(p.value<.05,\"*\",\"\"),\n  interpretation = c(\n    \"average vocab score at the mean age (for monolingual)\",\n    \"vocab increases over time (for monolingual children)\",\n    \"the increase in vocab becomes more gradual (for monolingual children)\",\n    \"no significant wiggliness to vocab trajectory of the average monolingual child\",\n    \"average vocab score at mean age is lower for bilingual vs monolingual children\",\n    \"no significant difference in linear trend of vocab for bilingual vs monolingual\",\n    \"curvature for vocab trajectory of bilingual children significantly differs from that of monolinguals\",\n    \"wiggliness for vocab trajectory of bilingual children significantly differs from that of monolinguals\"\n  )\n) |> gt::gt()\n```\n\nFrom the random effects, we get even more information!  \nSchool's vary in the average child vocab score at mean age with an SD of 4.5.  More school level variation in linear trends than in curvature. Schools with higher vocab scores at the mean age tend to have lower linear increase, and also a more negative curvature.  \nWithin schools, children vary in the vocab scores at mean age with an SD of 5.9. Lots of child-level variation in curvature and linear increases, slightly less variation in wiggliness. \n\n```{r}\nVarCorr(mod7)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### Az.rda - trajectories of memory, simple, and complex daily functioning tasks in patients with Alzheimer's<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#non-linear</span>\n  \nThese data are available at [https://uoepsy.github.io/data/Az.rda](https://uoepsy.github.io/data/Az.rda). You can load the dataset using:  \n```{r}\nload(url(\"https://uoepsy.github.io/data/Az.rda\"))\n```\nand you will find the `Az` object in your environment.  \n\nThe `Az` object contains information on 30 Participants with probable Alzheimer's Disease, who completed 3 tasks over 10 time points: A memory task, and two scales investigating ability to undertake complex activities of daily living (cADL) and simple activities of daily living (sADL). Performance on all of tasks was calculated as a percentage of total possible score, thereby ranging from 0 to 100. \n\nWe're interested in **whether performance on these tasks differed at the outset of the study, and if they differed in their subsequent change in performance**.  \n\n```{r}\n#| echo: false\ntibble(\n    variable = names(Az),\n    description = c(\"Unique Subject Identifier\",\"Time point of the study (1 to 10)\",\"Task type (Memory, cADL, sADL)\",\"Score on test (range 0 to 100)\")\n) |> gt::gt()\n```\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### midlifeape.csv - mid-life happiness slump in great apes<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#non-linear</span>\n\n```{r}\n#| include: false\ndf <- read_csv(\"https://uoepsy.github.io/data/midlife_ape.csv\")\n```\n\nPrevious research has evidenced a notable dip in happiness for middle-aged humans. Interestingly, this phenomenon has even been observed in other primates, such as chimpanzees.  \n\nThe present study is interested in examining **whether the 'middle-age slump' happens to a similar extent for Orangutans as it does for Chimpanzees.** \n\n`r n_distinct(df$apeID)` apes (`r n_distinct(df$apeID[df$species==\"chimp\"])` Chimps and `r n_distinct(df$apeID[df$species==\"orangutan\"])` Orangutans) were included in the study. All apes were studied from early adulthood (10-12 years old for most great apes), and researchers administered the Happiness in Primates (HiP) scale to each participant every 3 years, up until the age of 40.  \n\nData are available at [https://uoepsy.github.io/data/midlife_ape.csv](https://uoepsy.github.io/data/midlife_ape.csv){target=\"_blank\"}.  \n\nThe dataset has already been cleaned, and the researchers have confirmed that it includes `r n_distinct(df$apeID[df$species==\"chimp\"])` Chimps and `r n_distinct(df$apeID[df$species==\"orangutan\"])` Orangutans, and every ape has complete data (i.e. 10 rows for each ape).  \n\n```{r}\n#| echo: false\nmlape <- read_csv(\"https://uoepsy.github.io/data/midlife_ape.csv\")\ntibble(\n  variable=names(mlape),\n  description=c(\"Ape's Name (all names are chosen to be unique)\",\n                \"Age (in years) at assessment\",\n                \"Species (chimp v orangutan)\",\n                \"Happiness in Primate Scale (range 1 to 18)\",\n                \"Study visit (1 to 10)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/midlife_ape.csv\")\n\n# add polynomials\ndf <- df |> \n  mutate(\n    poly1 = poly(timepoint,2,raw=F)[,1],\n    poly2 = poly(timepoint,2,raw=F)[,2]\n  )\n\nmod1 = lmer(HiP ~ 1 + (poly1 + poly2) * species +\n            (1 + poly1 + poly2 | apeID), \n            data = df)\n\nsummary(mod1)\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### memorytap.csv - Memory Recall & Finger Tapping<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#binomial-outcome</span>\n\nResearchers are interested in investigating **whether, after accounting for effects of sentence length, rhythmic tapping of fingers aids memory recall.** They recruited 40 participants. Each participant was tasked with studying and then recalling 10 randomly generated sentences between 1 and 14 words long. For 5 of these sentences, participants were asked to tap their fingers along with speaking the sentence in both the study period and in the recall period. For the remaining 5 sentences, participants were asked to sit still.  \n\nData are available at [https://uoepsy.github.io/data/memorytap.csv](https://uoepsy.github.io/data/memorytap.csv), and contains information on the length (in words) of each sentence, the condition (static vs tapping) under which it was studied and recalled, and whether the participant was correct in recalling it.  \n\n```{r}\n#| echo: false\nmemtap <- read_csv(\"https://uoepsy.github.io/data/memorytap.csv\")\ntibble(\n  variable = names(memtap),\n  description = c(\"Participant Identifier (n=40)\",\"Number of words in sentence\",\"Condition under which sentence is studied and recalled ('static' = sitting still, 'tap' = tapping fingers along to sentence)\",\"Whether or not the sentence was correctly recalled\")\n) %>% gt::gt()\n```\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### nwl.RData - novel word learning<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#binomial-outcome</span>\n\nData are available at\n```{r}\nload(url(\"https://uoepsy.github.io/msmr/data/nwl.RData\"))\n```\n\nIn the `nwl` data set (accessed using the code above), participants with aphasia are separated into two groups based on the general location of their brain lesion: anterior vs. posterior. There is data on the numbers of correct and incorrect responses participants gave in each of a series of experimental blocks. There were 7 learning blocks, immediately followed by a test. Finally, participants also completed a follow-up test. Data were also collect from healthy controls. \n<br>\nOur broader research aim today is to **compare the two lesion location groups (those with anterior vs. posterior lesions) with respect to their accuracy of responses over the course of the study.**  \n<br>\n@fig-nwl shows the differences between lesion location groups in the average proportion of correct responses at each point in time (i.e., each block, test, and follow-up)\n\n```{r}\n#| label: fig-nwl\n#| echo: false\n#| fig.cap: \"Differences between groups in the average proportion of correct responses at each block\"\nload(url(\"https://uoepsy.github.io/msmr/data/nwl.RData\"))\nggplot(filter(nwl, !is.na(lesion_location)), aes(block, PropCorrect, \n                                            color=lesion_location, \n                                            shape=lesion_location)) +\n  #geom_line(aes(group=ID),alpha=.2) + \n  stat_summary(fun.data=mean_se, geom=\"pointrange\") + \n  stat_summary(data=filter(nwl, !is.na(lesion_location), block <= 7), \n                           fun=mean, geom=\"line\") + \n  geom_hline(yintercept=0.5, linetype=\"dashed\") + \n  geom_vline(xintercept=c(7.5, 8.5), linetype=\"dashed\") + \n  scale_x_continuous(breaks=1:9, labels=c(1:7, \"Test\", \"Follow-Up\")) + \n  theme_bw(base_size=10) + \n  labs(x=\"Block\", y=\"Proportion Correct\", shape=\"Lesion\\nLocation\", color=\"Lesion\\nLocation\")\n```\n\n```{r}\n#| echo: false\ndata.frame(\n  variable = names(nwl),\n  description = c(\"Whether participant is a stroke patient ('patient') or a healthy control ('control')\", \"Location of brain lesion: anterior vs posterior\",\"Experimental block (1-9). Blocks 1-7 were learning blocks, immediately followed by a test in block 8. Block 9 was a follow-up test at a later point\",\"Proportion of 30 responses in a given block that the participant got correct\",\"Number of responses (out of 30) in a given block that the participant got correct\",\"Number of responses (out of 30) in a given block that the participant got incorrect\",\"Participant Identifier\",\"Experimental phase, corresponding to experimental block(s): 'Learning', 'Immediate','Follow-up'\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### testenhancedlearning.RData<br><span class=\"tag\">\\#longitudinal</span><span class=\"tag\">\\#more-complex-groupings</span><span class=\"tag\">\\#binomial-outcome</span>\n\nAn experiment was run to conceptually replicate \"test-enhanced learning\" (Roediger & Karpicke, 2006): two groups of 25 participants were presented with material to learn. One group studied the material twice (`StudyStudy`), the other group studied the material once then did a test (`StudyTest`). Recall was tested immediately (one minute) after the learning session and one week later. The recall tests were composed of 175 items identified by a keyword (`Test_word`). \n\n**The critical (replication) prediction is that the `StudyStudy` group perform better on the immediate test, but the `StudyTest` group will retain the material better and thus perform better on the 1-week follow-up test.**  \n\nWe have two options for how we measure \"test performance\":  \n\nA) The time taken to *correctly* recall a given word.  \nB) Whether or not a given word was correctly recalled\n\nThe following code loads the data into your R environment by creating a variable called `tel`:\n\n```{r}\n#| eval: false\nload(url(\"https://uoepsy.github.io/data/testenhancedlearning.RData\"))\n```\n\n```{r} \n#| echo: false\nload(url(\"https://uoepsy.github.io/data/testenhancedlearning.RData\"))\ntibble(\n  variable=names(tel),\n  description=c(\"Unique Participant Identifier\", \"Group denoting whether the participant studied the material twice (StudyStudy), or studied it once then did a test (StudyTest)\",\"Time of recall test ('min' = Immediate, 'week' = One week later)\",\"Word being recalled (175 different test words)\",\"Whether or not the word was correctly recalled\",\"Time to recall word (milliseconds)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### msmr_trolley.csv - trolley problems<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#binomial-outcome</span>\n\nThe \"Trolley Problem\" is a thought experiment in moral philosophy that asks you to decide whether or not to pull a lever to divert a trolley. Pulling the lever changes the trolley direction from hitting 5 people to a track on which it will hit one person.  \n\n```{r}\n#| echo: false\nknitr::include_graphics(\"images/trolley.png\")\n```\n\nPrevious research has found that the \"framing\" of the problem will influence the decisions people make: \n\n```{r}\n#| echo: false\ntribble(\n  ~`positive frame`,~`neutral frame`,~`negative frame`,\n  \"5 people will be saved if you pull the lever; one person on another track will be saved if you do not pull the lever. All your actions are legal and understandable. Will you pull the lever?\",\"5 people will be saved if you pull the lever, but another person will die. One people will be saved if you do not pull the lever, but 5 people will die. All your actions are legal and understandable. Will you pull the lever?\",\n  \"One person will die if you pull the lever. 5 people will die if you do not pull the lever. All your actions are legal and understandable. Will you pull the lever?\"\n) |> gt::gt()\n```\n\nWe conducted a study to investigate **whether the framing effects on moral judgements depends upon the stakes (i.e. the number of lives saved)**.  \n\n120 participants were recruited, and each gave answers to 12 versions of the thought experiment. For each participant, four versions followed each of the positive/neutral/negative framings described above, and for each framing, 2 would save 5 people and 2 would save 15 people.  \n\nData are available at [https://uoepsy.github.io/data/msmr_trolley.csv](https://uoepsy.github.io/data/msmr_trolley.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(\n  variable = names(read_csv(\"https://uoepsy.github.io/data/msmr_trolley.csv\")),\n  description = c(\n    \"Participant ID\",\n    \"framing of the thought experiment (positive/neutral/negative\",\n    \"lives at stake in the thought experiment (5 or 15)\",\n    \"Whether or not the participant chose to pull the lever (1 = yes, 0 = no)\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n# TODO ANALYSIS\n```\n`r solend()`\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### monkey social status and problem solving ability<br><span class=\"tag\">\\#repeated-measures</span><span class=\"tag\">\\#binomial-outcome</span>\n\nOur primate researchers have been busy collecting more data. They have given a sample of Rhesus Macaques various problems to solve in order to receive treats. Troops of Macaques have a complex social structure, but adult monkeys tend can be loosely categorised as having either a \"dominant\" or \"subordinate\" status. The monkeys in our sample are either adolescent monkeys, subordinate adults, or dominant adults. Each monkey attempted various problems before they got bored/distracted/full of treats. Each problems were classed as either \"easy\" or \"difficult\", and the researchers recorded whether or not the monkey solved each problem. \n\nWe're interested in **how the social status of monkeys is associated with the ability to solve problems**.  \n\nData are available at [https://uoepsy.github.io/data/msmr_monkeystatus.csv](https://uoepsy.github.io/data/msmr_monkeystatus.csv){target=\"_blank\"}.  \n\n```{r}\n#| echo: false\ntibble(variable=\n         names(read_csv(\"https://uoepsy.github.io/data/msmr_monkeystatus.csv\")),\n       description = c(\n         \"Social Status of monkey (adolescent, subordinate adult, or dominant adult)\",\n         \"Problem difficulty ('easy' vs 'difficult')\",\n         \"Monkey Name\",\n         \"Whether or not the problem was successfully solved by the monkey\")\n) |> gt::gt()\n```\n\n:::\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r}\n#| eval: false\ndf <- read_csv(\"https://uoepsy.github.io/data/msmr_monkeystatus.csv\")\n\n# relevel difficulty\ndf$difficulty <- factor(df$difficulty, \n                        levels=c(\"easy\",\"difficult\"))\n\nmod1 <- glmer(solved ~ difficulty + status +\n                (1 + difficulty | monkeyID), \n              family=binomial,\n              data = df)\n\nsummary(mod1)\n```\n`r solend()`"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html"],"number-sections":false,"output-file":"00_datasets.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","toc_float":true,"link-citations":true,"theme":["cosmo","assets/style-labs.scss"],"title":"Practice Datasets","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}